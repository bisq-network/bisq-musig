<!doctype html>
<html>
<head>
    <title>IntelliJ Markdown Preview</title>
    <meta http-equiv="Content-Security-Policy" content="default-src 'none';
script-src 'self';
style-src 'unsafe-inline';
img-src file: *;
connect-src 'none';
font-src * data: *;
object-src 'none';
media-src 'none';
child-src 'none';">
    <style type="text/css">.CtxtMenu_InfoClose {
        top: .2em;
        right: .2em;
    }

    .CtxtMenu_InfoContent {
        overflow: auto;
        text-align: left;
        font-size: 80%;
        padding: .4em .6em;
        border: 1px inset;
        margin: 1em 0px;
        max-height: 20em;
        max-width: 30em;
        background-color: #EEEEEE;
        white-space: normal;
    }

    .CtxtMenu_Info.CtxtMenu_MousePost {
        outline: none;
    }

    .CtxtMenu_Info {
        position: fixed;
        left: 50%;
        width: auto;
        text-align: center;
        border: 3px outset;
        padding: 1em 2em;
        background-color: #DDDDDD;
        color: black;
        cursor: default;
        font-family: message-box;
        font-size: 120%;
        font-style: normal;
        text-indent: 0;
        text-transform: none;
        line-height: normal;
        letter-spacing: normal;
        word-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        float: none;
        z-index: 201;
        border-radius: 15px; /* Opera 10.5 and IE9 */
        -webkit-border-radius: 15px; /* Safari and Chrome */
        -moz-border-radius: 15px; /* Firefox */
        -khtml-border-radius: 15px; /* Konqueror */
        box-shadow: 0px 10px 20px #808080; /* Opera 10.5 and IE9 */
        -webkit-box-shadow: 0px 10px 20px #808080; /* Safari 3 & Chrome */
        -moz-box-shadow: 0px 10px 20px #808080; /* Forefox 3.5 */
        -khtml-box-shadow: 0px 10px 20px #808080; /* Konqueror */
        filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */
    }
    </style>
    <style type="text/css">.CtxtMenu_MenuClose {
        position: absolute;
        cursor: pointer;
        display: inline-block;
        border: 2px solid #AAA;
        border-radius: 18px;
        -webkit-border-radius: 18px; /* Safari and Chrome */
        -moz-border-radius: 18px; /* Firefox */
        -khtml-border-radius: 18px; /* Konqueror */
        font-family: "Courier New", Courier;
        font-size: 24px;
        color: #F0F0F0
    }

    .CtxtMenu_MenuClose span {
        display: block;
        background-color: #AAA;
        border: 1.5px solid;
        border-radius: 18px;
        -webkit-border-radius: 18px; /* Safari and Chrome */
        -moz-border-radius: 18px; /* Firefox */
        -khtml-border-radius: 18px; /* Konqueror */
        line-height: 0;
        padding: 8px 0 6px /* may need to be browser-specific */
    }

    .CtxtMenu_MenuClose:hover {
        color: white !important;
        border: 2px solid #CCC !important
    }

    .CtxtMenu_MenuClose:hover span {
        background-color: #CCC !important
    }

    .CtxtMenu_MenuClose:hover:focus {
        outline: none
    }
    </style>
    <style type="text/css">.CtxtMenu_Menu {
        position: absolute;
        background-color: white;
        color: black;
        width: auto;
        padding: 5px 0px;
        border: 1px solid #CCCCCC;
        margin: 0;
        cursor: default;
        font: menu;
        text-align: left;
        text-indent: 0;
        text-transform: none;
        line-height: normal;
        letter-spacing: normal;
        word-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        float: none;
        z-index: 201;
        border-radius: 5px; /* Opera 10.5 and IE9 */
        -webkit-border-radius: 5px; /* Safari and Chrome */
        -moz-border-radius: 5px; /* Firefox */
        -khtml-border-radius: 5px; /* Konqueror */
        box-shadow: 0px 10px 20px #808080; /* Opera 10.5 and IE9 */
        -webkit-box-shadow: 0px 10px 20px #808080; /* Safari 3 & Chrome */
        -moz-box-shadow: 0px 10px 20px #808080; /* Forefox 3.5 */
        -khtml-box-shadow: 0px 10px 20px #808080; /* Konqueror */
    }

    .CtxtMenu_MenuItem {
        padding: 1px 2em;
        background: transparent;
    }

    .CtxtMenu_MenuArrow {
        position: absolute;
        right: .5em;
        padding-top: .25em;
        color: #666666;
        font-family: null;
        font-size: .75em
    }

    .CtxtMenu_MenuActive .CtxtMenu_MenuArrow {
        color: white
    }

    .CtxtMenu_MenuArrow.CtxtMenu_RTL {
        left: .5em;
        right: auto
    }

    .CtxtMenu_MenuCheck {
        position: absolute;
        left: .7em;
        font-family: null
    }

    .CtxtMenu_MenuCheck.CtxtMenu_RTL {
        right: .7em;
        left: auto
    }

    .CtxtMenu_MenuRadioCheck {
        position: absolute;
        left: .7em;
    }

    .CtxtMenu_MenuRadioCheck.CtxtMenu_RTL {
        right: .7em;
        left: auto
    }

    .CtxtMenu_MenuInputBox {
        padding-left: 1em;
        right: .5em;
        color: #666666;
        font-family: null;
    }

    .CtxtMenu_MenuInputBox.CtxtMenu_RTL {
        left: .1em;
    }

    .CtxtMenu_MenuComboBox {
        left: .1em;
        padding-bottom: .5em;
    }

    .CtxtMenu_MenuSlider {
        left: .1em;
    }

    .CtxtMenu_SliderValue {
        position: absolute;
        right: .1em;
        padding-top: .25em;
        color: #333333;
        font-size: .75em
    }

    .CtxtMenu_SliderBar {
        outline: none;
        background: #d3d3d3
    }

    .CtxtMenu_MenuLabel {
        padding: 1px 2em 3px 1.33em;
        font-style: italic
    }

    .CtxtMenu_MenuRule {
        border-top: 1px solid #DDDDDD;
        margin: 4px 3px;
    }

    .CtxtMenu_MenuDisabled {
        color: GrayText
    }

    .CtxtMenu_MenuActive {
        background-color: #606872;
        color: white;
    }

    .CtxtMenu_MenuDisabled:focus {
        background-color: #E8E8E8
    }

    .CtxtMenu_MenuLabel:focus {
        background-color: #E8E8E8
    }

    .CtxtMenu_ContextMenu:focus {
        outline: none
    }

    .CtxtMenu_ContextMenu .CtxtMenu_MenuItem:focus {
        outline: none
    }

    .CtxtMenu_SelectionMenu {
        position: relative;
        float: left;
        border-bottom: none;
        -webkit-box-shadow: none;
        -webkit-border-radius: 0px;
    }

    .CtxtMenu_SelectionItem {
        padding-right: 1em;
    }

    .CtxtMenu_Selection {
        right: 40%;
        width: 50%;
    }

    .CtxtMenu_SelectionBox {
        padding: 0em;
        max-height: 20em;
        max-width: none;
        background-color: #FFFFFF;
    }

    .CtxtMenu_SelectionDivider {
        clear: both;
        border-top: 2px solid #000000;
    }

    .CtxtMenu_Menu .CtxtMenu_MenuClose {
        top: -10px;
        left: -10px
    }
    </style>
    <style id="MJX-SVG-styles">
        mjx-container[jax="SVG"] {
            direction: ltr;
        }

        mjx-container[jax="SVG"] > svg {
            overflow: visible;
            min-height: 1px;
            min-width: 1px;
        }

        mjx-container[jax="SVG"] > svg a {
            fill: blue;
            stroke: blue;
        }

        mjx-assistive-mml {
            position: absolute !important;
            top: 0px;
            left: 0px;
            clip: rect(1px, 1px, 1px, 1px);
            padding: 1px 0px 0px 0px !important;
            border: 0px !important;
            display: block !important;
            width: auto !important;
            overflow: hidden !important;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        mjx-assistive-mml[display="block"] {
            width: 100% !important;
        }

        mjx-container[jax="SVG"][display="true"] {
            display: block;
            text-align: center;
            margin: 1em 0;
        }

        mjx-container[jax="SVG"][display="true"][width="full"] {
            display: flex;
        }

        mjx-container[jax="SVG"][justify="left"] {
            text-align: left;
        }

        mjx-container[jax="SVG"][justify="right"] {
            text-align: right;
        }

        g[data-mml-node="merror"] > g {
            fill: red;
            stroke: red;
        }

        g[data-mml-node="merror"] > rect[data-background] {
            fill: yellow;
            stroke: none;
        }

        g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
            stroke-width: 70px;
            fill: none;
        }

        g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
            stroke-width: 70px;
            fill: none;
        }

        g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
            stroke-dasharray: 140;
        }

        g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
            stroke-linecap: round;
            stroke-dasharray: 0, 140;
        }

        g[data-mml-node="mtable"] > g > svg {
            overflow: visible;
        }

        [jax="SVG"] mjx-tool {
            display: inline-block;
            position: relative;
            width: 0;
            height: 0;
        }

        [jax="SVG"] mjx-tool > mjx-tip {
            position: absolute;
            top: 0;
            left: 0;
        }

        mjx-tool > mjx-tip {
            display: inline-block;
            padding: .2em;
            border: 1px solid #888;
            font-size: 70%;
            background-color: #F8F8F8;
            color: black;
            box-shadow: 2px 2px 5px #AAAAAA;
        }

        g[data-mml-node="maction"][data-toggle] {
            cursor: pointer;
        }

        mjx-status {
            display: block;
            position: fixed;
            left: 1em;
            bottom: 1em;
            min-width: 25%;
            padding: .2em .4em;
            border: 1px solid #888;
            font-size: 90%;
            background-color: #F8F8F8;
            color: black;
        }

        foreignObject[data-mjx-xml] {
            font-family: initial;
            line-height: normal;
            overflow: visible;
        }

        mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
            stroke-width: 3;
        }
    </style>
    <style>/* Reworked by IntelliJ Team The MIT License (MIT) Copyright (c) JetBrains Adapted from https://github.com/sindresorhus/github-markdown-css The MIT License (MIT) Copyright (c) Sindre Sorhus &lt;sindresorhus@gmail.com&gt; (sindresorhus.com) Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. */
    @font-face {
        font-family: octicons-anchor;
        src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAYcAA0AAAAACjQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAABMAAAABwAAAAca8vGTk9TLzIAAAFMAAAARAAAAFZG1VHVY21hcAAAAZAAAAA+AAABQgAP9AdjdnQgAAAB0AAAAAQAAAAEACICiGdhc3AAAAHUAAAACAAAAAj//wADZ2x5ZgAAAdwAAADRAAABEKyikaNoZWFkAAACsAAAAC0AAAA2AtXoA2hoZWEAAALgAAAAHAAAACQHngNFaG10eAAAAvwAAAAQAAAAEAwAACJsb2NhAAADDAAAAAoAAAAKALIAVG1heHAAAAMYAAAAHwAAACABEAB2bmFtZQAAAzgAAALBAAAFu3I9x/Nwb3N0AAAF/AAAAB0AAAAvaoFvbwAAAAEAAAAAzBdyYwAAAADP2IQvAAAAAM/bz7t4nGNgZGFgnMDAysDB1Ml0hoGBoR9CM75mMGLkYGBgYmBlZsAKAtJcUxgcPsR8iGF2+O/AEMPsznAYKMwIkgMA5REMOXicY2BgYGaAYBkGRgYQsAHyGMF8FgYFIM0ChED+h5j//yEk/3KoSgZGNgYYk4GRCUgwMaACRoZhDwCs7QgGAAAAIgKIAAAAAf//AAJ4nHWMMQrCQBBF/0zWrCCIKUQsTDCL2EXMohYGSSmorScInsRGL2DOYJe0Ntp7BK+gJ1BxF1stZvjz/v8DRghQzEc4kIgKwiAppcA9LtzKLSkdNhKFY3HF4lK69ExKslx7Xa+vPRVS43G98vG1DnkDMIBUgFN0MDXflU8tbaZOUkXUH0+U27RoRpOIyCKjbMCVejwypzJJG4jIwb43rfl6wbwanocrJm9XFYfskuVC5K/TPyczNU7b84CXcbxks1Un6H6tLH9vf2LRnn8Ax7A5WQAAAHicY2BkYGAA4teL1+yI57f5ysDNwgAC529f0kOmWRiYVgEpDgYmEA8AUzEKsQAAAHicY2BkYGB2+O/AEMPCAAJAkpEBFbAAADgKAe0EAAAiAAAAAAQAAAAEAAAAAAAAKgAqACoAiAAAeJxjYGRgYGBhsGFgYgABEMkFhAwM/xn0QAIAD6YBhwB4nI1Ty07cMBS9QwKlQapQW3VXySvEqDCZGbGaHULiIQ1FKgjWMxknMfLEke2A+IJu+wntrt/QbVf9gG75jK577Lg8K1qQPCfnnnt8fX1NRC/pmjrk/zprC+8D7tBy9DHgBXoWfQ44Av8t4Bj4Z8CLtBL9CniJluPXASf0Lm4CXqFX8Q84dOLnMB17N4c7tBo1AS/Qi+hTwBH4rwHHwN8DXqQ30XXAS7QaLwSc0Gn8NuAVWou/gFmnjLrEaEh9GmDdDGgL3B4JsrRPDU2hTOiMSuJUIdKQQayiAth69r6akSSFqIJuA19TrzCIaY8sIoxyrNIrL//pw7A2iMygkX5vDj+G+kuoLdX4GlGK/8Lnlz6/h9MpmoO9rafrz7ILXEHHaAx95s9lsI7AHNMBWEZHULnfAXwG9/ZqdzLI08iuwRloXE8kfhXYAvE23+23DU3t626rbs8/8adv+9DWknsHp3E17oCf+Z48rvEQNZ78paYM38qfk3v/u3l3u3GXN2Dmvmvpf1Srwk3pB/VSsp512bA/GG5i2WJ7wu430yQ5K3nFGiOqgtmSB5pJVSizwaacmUZzZhXLlZTq8qGGFY2YcSkqbth6aW1tRmlaCFs2016m5qn36SbJrqosG4uMV4aP2PHBmB3tjtmgN2izkGQyLWprekbIntJFing32a5rKWCN/SdSoga45EJykyQ7asZvHQ8PTm6cslIpwyeyjbVltNikc2HTR7YKh9LBl9DADC0U/jLcBZDKrMhUBfQBvXRzLtFtjU9eNHKin0x5InTqb8lNpfKv1s1xHzTXRqgKzek/mb7nB8RZTCDhGEX3kK/8Q75AmUM/eLkfA+0Hi908Kx4eNsMgudg5GLdRD7a84npi+YxNr5i5KIbW5izXas7cHXIMAau1OueZhfj+cOcP3P8MNIWLyYOBuxL6DRylJ4cAAAB4nGNgYoAALjDJyIAOWMCiTIxMLDmZedkABtIBygAAAA==) format('woff');
    }

    body {
        -webkit-text-size-adjust: 100%;
        -ms-text-size-adjust: 100%;
        font-family: Helvetica, Arial, freesans, sans-serif;
        font-size: 14px;
        line-height: 1.6;
        word-wrap: break-word;
        margin: 0 2em;
    }

    strong {
        font-weight: bold;
    }

    img {
        border: 0;
    }

    input {
        color: inherit;
        font: inherit;
        margin: 0;
        line-height: normal;
    }

    html input[disabled] {
        cursor: default;
    }

    input[type="checkbox"] {
        box-sizing: border-box;
        padding: 0;
    }

    body * {
        box-sizing: border-box;
    }

    input {
        font: 13px/1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
    }

    a {
        text-decoration: none;
    }

    a:hover, a:active {
        text-decoration: underline;
    }

    hr {
        height: 1px;
        padding: 0;
        margin: 20px 0;
        border: 0 none;
    }

    hr:before {
        display: table;
        content: "";
    }

    hr:after {
        display: table;
        clear: both;
        content: "";
    }

    blockquote {
        margin: 0;
    }

    ul, ol {
        padding: 0;
        margin-top: 0;
        margin-bottom: 0;
    }

    ol ol, ul ol {
        list-style-type: lower-roman;
    }

    ul ul ol, ul ol ol, ol ul ol, ol ol ol {
        list-style-type: lower-alpha;
    }

    dd {
        margin-left: 0;
    }

    .octicon {
        font: normal normal normal 16px/1 octicons-anchor;
        display: inline-block;
        text-decoration: none;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }

    .octicon-link:before {
        content: '\f05c';
    }

    .markdown-body & gt

    ;
    *:first-child {
        margin-top: 0 !important;
    }

    .markdown-body & gt

    ;
    *:last-child {
        margin-bottom: 0 !important;
    }

    .anchor {
        position: absolute;
        top: 0;
        left: 0;
        display: block;
        padding-right: 6px;
        padding-left: 30px;
        margin-left: -30px;
    }

    .anchor:focus {
        outline: none;
    }

    h1, h2, h3, h4, h5, h6 {
        position: relative;
        margin-top: 1em;
        margin-bottom: 16px;
        font-weight: bold;
        line-height: 1.4;
    }

    h1 .octicon-link, h2 .octicon-link, h3 .octicon-link, h4 .octicon-link, h5 .octicon-link, h6 .octicon-link {
        display: none;
        color: #000;
        vertical-align: middle;
    }

    h1:hover .anchor, h2:hover .anchor, h3:hover .anchor, h4:hover .anchor, h5:hover .anchor, h6:hover .anchor {
        padding-left: 8px;
        margin-left: -30px;
        text-decoration: none;
    }

    h1:hover .anchor .octicon-link, h2:hover .anchor .octicon-link, h3:hover .anchor .octicon-link, h4:hover .anchor .octicon-link, h5:hover .anchor .octicon-link, h6:hover .anchor .octicon-link {
        display: inline-block;
    }

    h1 {
        font-size: 2.2em;
        padding-top: 0.6em;
    }

    h1 .anchor {
        line-height: 1;
    }

    h2 {
        font-size: 1.8em;
        line-height: 1.2;
        padding-top: 0.6em;
    }

    h2 .anchor {
        line-height: 1.2;
    }

    h3 {
        font-size: 1.3em;
        line-height: 1;
        padding-top: 0.6em;
    }

    h3 .anchor {
        line-height: 1.2;
    }

    h4 {
        font-size: 1em;
    }

    h4 .anchor {
        line-height: 1.2;
    }

    h5 {
        font-size: 1em;
    }

    h5 .anchor {
        line-height: 1.1;
    }

    h6 {
        font-size: 1em;
    }

    h6 .anchor {
        line-height: 1.1;
    }

    p, blockquote, ul, ol, dl, table, pre {
        margin-top: 16px;
        margin-bottom: 16px;
    }

    pre.frontmatter-header {
        background-color: transparent;
        margin: 0;
        padding: 0;
    }

    ul, ol {
        padding-left: 2em;
    }

    ul ul, ul ol, ol ol, ol ul {
        margin-top: 0;
        margin-bottom: 0;
    }

    li & gt

    ;
    p {
        margin-top: 0;
        margin-bottom: 0;
    }

    dl {
        padding: 0;
    }

    dl dt {
        padding: 0;
        margin-top: 16px;
        font-size: 1em;
        font-style: italic;
        font-weight: bold;
    }

    dl dd {
        padding: 0 16px;
        margin-bottom: 16px;
    }

    blockquote {
        padding: 10px 10px 10px 16px;
        border-left: 2px solid;
        border-radius: 0 3px 3px 0;
    }

    blockquote & gt

    ;
    :first-child {
        margin-top: 0;
    }

    blockquote & gt

    ;
    :last-child {
        margin-bottom: 0;
    }

    table {
        display: block;
        width: 100%;
        overflow: auto;
        word-break: normal;
        border-collapse: collapse;
        border-spacing: 0;
        font-size: 1em;
    }

    table th {
        font-weight: bold;
    }

    table th, table td {
        padding: 6px 13px;
        background: transparent;
    }

    table tr {
        border-top: 1px solid;
    }

    img {
        max-width: 100%;
        box-sizing: border-box;
    }

    code {
        font: 0.9em "JetBrains Mono", Consolas, "Liberation Mono", Menlo, Courier, monospace;
        padding: 0.2em 0.4em;
        margin: 2px;
        border-radius: 3px;
    }

    pre & gt

    ;
    code {
        padding: 0;
        margin: 0;
        font-size: 100%;
        word-break: normal;
        white-space: pre;
        background: transparent;
        border: 0;
    }

    .highlight {
        margin-bottom: 16px;
    }

    .highlight pre, pre {
        font: 0.85em "JetBrains Mono", Consolas, "Liberation Mono", Menlo, Courier, monospace;
        padding: 16px;
        overflow: auto;
        line-height: 1.45;
        border-radius: 3px;
    }

    pre code {
        display: inline;
        max-width: initial;
        padding: 0;
        margin: 0;
        overflow: initial;
        line-height: inherit;
        word-wrap: normal;
        background-color: transparent;
        border: 0;
    }

    pre code:before, pre code:after {
        content: normal;
    }

    kbd {
        font: 0.9em "JetBrains Mono", Consolas, "Liberation Mono", Menlo, Courier, monospace;
        padding: 0.2em 0.4em;
        margin: 2px;
        border-radius: 3px;
    }

    .task-list-item {
        list-style-type: none;
    }

    .task-list-item + .task-list-item {
        margin-top: 3px;
    }

    .task-list-item input {
        margin: 0 0.35em 0.25em -0.6em;
        vertical-align: middle;
    }

    :checked + .radio-label {
        z-index: 1;
        position: relative;
    }

    span.user-del {
        text-decoration: line-through;
    }

    ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
    }

    ::-webkit-scrollbar-thumb {
        -webkit-border-radius: 10px;
    }

    ::-webkit-scrollbar-track:vertical {
        -webkit-box-shadow: -1px 0 0 #ededed;
    }

    ::-webkit-scrollbar-track {
        background-color: transparent;
    }

    ::-webkit-scrollbar {
        width: 6px;
    }</style>
    <style>:root {
        --default-font-size: 22px;
        --scale: 1.0;
    }

    body {
        background-color: rgba(30, 31, 34, 255.0);
        font-size: var(--default-font-size) !important;
        transform: scale(var(--scale)) !important;
        transform-origin: 0 0;
    }

    body, p, blockquote, ul, ol, dl, table, pre, code, tr {
        color: rgba(188, 190, 196, 255.0);
    }

    a {
        color: rgba(107, 155, 250, 255.0);
    }

    table td, table th {
        border: 1px solid rgba(57, 59, 64, 255.0);
    }

    hr {
        background-color: rgba(57, 59, 64, 255.0);
    }

    kbd, tr {
        border: 1px solid rgba(57, 59, 64, 255.0);
    }

    h6 {
        color: rgba(111, 115, 122, 255.0);
    }

    blockquote {
        border-left: 2px solid rgba(107, 155, 250, 0.4);
    }

    blockquote, code, pre {
        background-color: rgba(212, 222, 231, 0.09803921568627451);
    }

    ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
        background-color: rgba(0, 0, 0, 0);
    }

    ::-webkit-scrollbar-track {
        background-color: rgba(0, 0, 0, 0);
    }

    ::-webkit-scrollbar-track:hover {
        background-color: rgba(0, 0, 0, 0);
    }

    ::-webkit-scrollbar-thumb {
        background-color: rgba(166, 166, 166, 0.278431);
        border-radius: 0px;
        border-width: 1px;
        border-style: solid;
        border-color: rgba(0, 0, 0, 0);
        background-clip: padding-box;
        outline: 1px solid rgba(56, 56, 56, 0.278431);
        outline-offset: -1px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background-color: rgba(166, 166, 166, 0.349020);
        border-radius: 0px;
        border-width: 1px;
        border-style: solid;
        border-color: rgba(0, 0, 0, 0);
        background-clip: padding-box;
        outline: 1px solid rgba(56, 56, 56, 0.349020);
        outline-offset: -1px;
    }

    ::-webkit-scrollbar-corner {
        background-color: rgba(0, 0, 0, 0);
    }

    ::-webkit-scrollbar-button {
        display: none;
    }</style>
    <style>/* Copyright 2000-2021 JetBrains s.r.o. and contributors. Use of this source code is governed by the Apache 2.0 license that can be found in the LICENSE file. */
    .code-fence-highlighter-copy-button {
        display: flex;
        position: absolute;
        float: left;
        margin-left: -1em;
        margin-top: -1em;
    }

    .code-fence-highlighter-copy-button-icon {
        visibility: hidden;
        max-width: 1em;
    }

    .code-fence:hover .code-fence-highlighter-copy-button-icon {
        visibility: visible; /*noinspection CssUnknownTarget*/
        content: url("copy-button-copy-icon.png");
    }

    .code-fence:hover .code-fence-highlighter-copy-button:hover .code-fence-highlighter-copy-button-icon { /*noinspection CssUnknownTarget*/
        content: url("copy-button-copy-icon-hovered.png");
        cursor: pointer;
    }

    .code-fence-highlighter-copy-button .tooltiptext {
        visibility: hidden;
        width: 120px;
        background-color: rgba(85, 85, 85, 0.4);
        color: #fff;
        text-align: center;
        border-radius: 6px;
        padding: 2px 0;
        position: absolute;
        font-size: 10px;
        z-index: 1;
        top: -4px;
        left: 120%;
        opacity: 0;
        transition: opacity 0.3s;
    }

    .code-fence-highlighter-copy-button:hover .tooltiptext {
        visibility: visible;
        opacity: 1;
    }</style>
    <style>/* Copyright 2000-2021 JetBrains s.r.o. and contributors. Use of this source code is governed by the Apache 2.0 license that can be found in the LICENSE file. */
    .run-icon & gt

    ;
    img {
        max-width: 1em;
        vertical-align: text-top;
        margin-right: 0.3em;
    }

    .code-block {
        position: absolute;
        left: 1em;
    }

    .hidden {
        display: none;
    }</style>
</head>
<body>
<div md-src-pos="0..14809">
    <h1 id="single-transaction-protocol-for-bisq" md-src-pos="0..38">Single Transaction Protocol for Bisq</h1>
    <h2 id="prelimery" md-src-pos="40..52">Prelimery</h2>
    <h3 id="goal" md-src-pos="54..62">Goal</h3>
    <p md-src-pos="64..405"><span md-src-pos="64..74">Currently,</span> <span md-src-pos="75..122">Bisq uses 4 transaction to make a normal trade.</span> <span md-src-pos="123..149">This causes a lot of fees,</span>
        <span md-src-pos="150..214">which in higher fee environment will get increasingly a problem.</span> <span md-src-pos="215..220">Also,</span> <span md-src-pos="221..280">these 4 transactions reveal the bitcoin script used for the</span>
        <span md-src-pos="281..290">multisig.</span> <span md-src-pos="291..324">This is a limitation for privacy.</span> <span md-src-pos="325..405">The goal of this protocol is to reduce fees and have more privacy using Taproot.</span>
    </p>
    <h3 id="paying-fees" md-src-pos="407..422">Paying fees</h3>
    <p md-src-pos="424..867"><span md-src-pos="424..451">To keep this article short,</span> <span md-src-pos="452..493">I am omitting the problem of paying fees,</span> <span md-src-pos="494..559">as it can be added to the system quite easily afterward and doesn</span>'<span
            md-src-pos="560..585">t have much of an impact.</span> <span md-src-pos="586..632">There are different approaches to paying fees,</span> <span md-src-pos="633..768">obviously the easiest would be to just have another output in the transaction which pays the fees like it is done in the current model.</span>
        <span md-src-pos="769..786">But this approach</span> <span md-src-pos="787..815">results in many small UTXOs.</span> <span md-src-pos="816..867">The discussion of fees is being moved to elsewhere.</span></p>
    <h2 id="trade-protocol-happy-path" md-src-pos="869..898">Trade protocol, happy path</h2>
    <p md-src-pos="900..1220"><span md-src-pos="900..957">Alice and Bob deposit their amounts into a 2of2 multisig.</span> <span md-src-pos="958..999">Alice and Bob create random private keys,</span> <span
            md-src-pos="1000..1052">which are in no way connected to other private keys.</span> <span md-src-pos="1053..1057">Note</span>: <span md-src-pos="1059..1073">In HD Wallets,</span> <span
            md-src-pos="1074..1104">which is the current standard,</span> <span md-src-pos="1105..1170">private keys are being derived from each other using a chaincode.</span> <span md-src-pos="1171..1220">So the sequence of private keys is deterministic.</span>
    </p>
    <p md-src-pos="1222..1389"><span md-src-pos="1222..1265">For the alternative paths of this protocol,</span> <span md-src-pos="1266..1325">Alice and Bob need to prepare some pre-signed transactions.</span> <span
            md-src-pos="1326..1389">To do the signing process Alice and Bob use MuSig2 as Protocol.</span></p>
    <p md-src-pos="1391..1663"><span md-src-pos="1391..1427">A Schnorr based 2of2 multisignature,</span> <span md-src-pos="1428..1489">makes use of the additivity of the keys and their signatures.</span> <span
            md-src-pos="1490..1510">Instead of a script,</span> <span md-src-pos="1511..1532">we have a public key,</span> <span md-src-pos="1533..1543">which is a</span> (<span md-src-pos="1545..1553">weighted</span>)
        <span md-src-pos="1555..1586">sum of Alice and Bobs pub keys.</span> <span md-src-pos="1587..1611">The aggregated key locks</span> <span md-src-pos="1612..1615">the</span> <span md-src-pos="1616..1663">taproot transaction output in a key spend path.</span>
    </p>
    <p md-src-pos="1665..1948"><span md-src-pos="1665..1699">The details of the MuSig2 protocol</span> (<span md-src-pos="1701..1724">and adaptive signatures</span>) <span
            md-src-pos="1726..1749">are described in length</span> <a href="file:/mnt/work/extra/dev/bisq-musig/concept/MuSig2adaptor-rust.md" md-src-pos="1750..1789">here locally</a> <span
            md-src-pos="1790..1792">or</span> <a href="https://html-preview.github.io/?url=https://github.com/bisq-network/bisq-musig/blob/main/concept/renderedForWeb/MuSig2adaptor-rust.html" md-src-pos="1793..1947">here
        on the web</a><span md-src-pos="1947..1948">.</span></p>
    <p md-src-pos="1950..2029"><span md-src-pos="1950..2029">The 2 public key from Alice and Bob can be combined to a aggregated public key.</span></p>
    <blockquote md-src-pos="2030..2186">
        <p md-src-pos="2032..2186"><span class="math" inline="true" md-src-pos="2032..2049"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="0" style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="13.677ex" height="2.074ex" role="img" focusable="false" viewBox="0 -759 6045.3 916.8" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: -0.357ex;">
        <defs>
         <path id="MJX-1-TEX-I-1D443"
               d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path>
         <path id="MJX-1-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
         <path id="MJX-1-TEX-N-3A"
               d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path>
         <path id="MJX-1-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path>
         <path id="MJX-1-TEX-I-1D44E"
               d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
         <path id="MJX-1-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path>
         <path id="MJX-1-TEX-I-1D44F"
               d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="msup">
           <g data-mml-node="mi">
            <use data-c="1D443" xlink:href="#MJX-1-TEX-I-1D443"></use>
           </g>
           <g data-mml-node="mo" transform="translate(839.5,363) scale(0.707)">
            <use data-c="2032" xlink:href="#MJX-1-TEX-V-2032"></use>
           </g>
          </g>
          <g data-mml-node="mo" transform="translate(1361.7,0)">
           <g data-mml-node="text">
            <use data-c="3A" xlink:href="#MJX-1-TEX-N-3A"></use>
           </g>
           <g data-mml-node="text" transform="translate(278,0)">
            <use data-c="3D" xlink:href="#MJX-1-TEX-N-3D"></use>
           </g>
          </g>
          <g data-mml-node="msub" transform="translate(2695.5,0)">
           <g data-mml-node="mi">
            <use data-c="1D443" xlink:href="#MJX-1-TEX-I-1D443"></use>
           </g>
           <g data-mml-node="mi" transform="translate(675,-150) scale(0.707)">
            <use data-c="1D44E" xlink:href="#MJX-1-TEX-I-1D44E"></use>
           </g>
          </g>
          <g data-mml-node="mo" transform="translate(4016.7,0)">
           <use data-c="2B" xlink:href="#MJX-1-TEX-N-2B"></use>
          </g>
          <g data-mml-node="msub" transform="translate(5017,0)">
           <g data-mml-node="mi">
            <use data-c="1D443" xlink:href="#MJX-1-TEX-I-1D443"></use>
           </g>
           <g data-mml-node="mi" transform="translate(675,-150) scale(0.707)">
            <use data-c="1D44F" xlink:href="#MJX-1-TEX-I-1D44F"></use>
           </g>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msup><mi>P</mi><mo data-mjx-alternate="1">′</mo></msup><mo>:=</mo><msub>
          <mi>P</mi>
          <mi>a</mi>
         </msub><mo>+</mo><msub>
          <mi>P</mi>
          <mi>b</mi>
         </msub>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span> <br><span md-src-pos="2054..2100">and the same for the corresponding private key</span> <br><span class="math" inline="true" md-src-pos="2105..2122"><mjx-container
                class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="1" style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="12.362ex" height="2.156ex" role="img" focusable="false" viewBox="0 -759 5463.9 953" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: -0.439ex;">
        <defs>
         <path id="MJX-2-TEX-I-1D45D"
               d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path>
         <path id="MJX-2-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
         <path id="MJX-2-TEX-N-3A"
               d="M78 370Q78 394 95 412T138 430Q162 430 180 414T199 371Q199 346 182 328T139 310T96 327T78 370ZM78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path>
         <path id="MJX-2-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path>
         <path id="MJX-2-TEX-I-1D44E"
               d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
         <path id="MJX-2-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path>
         <path id="MJX-2-TEX-I-1D44F"
               d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="msup">
           <g data-mml-node="mi">
            <use data-c="1D45D" xlink:href="#MJX-2-TEX-I-1D45D"></use>
           </g>
           <g data-mml-node="mo" transform="translate(536,363) scale(0.707)">
            <use data-c="2032" xlink:href="#MJX-2-TEX-V-2032"></use>
           </g>
          </g>
          <g data-mml-node="mo" transform="translate(1058.2,0)">
           <g data-mml-node="text">
            <use data-c="3A" xlink:href="#MJX-2-TEX-N-3A"></use>
           </g>
           <g data-mml-node="text" transform="translate(278,0)">
            <use data-c="3D" xlink:href="#MJX-2-TEX-N-3D"></use>
           </g>
          </g>
          <g data-mml-node="msub" transform="translate(2392,0)">
           <g data-mml-node="mi">
            <use data-c="1D45D" xlink:href="#MJX-2-TEX-I-1D45D"></use>
           </g>
           <g data-mml-node="mi" transform="translate(536,-150) scale(0.707)">
            <use data-c="1D44E" xlink:href="#MJX-2-TEX-I-1D44E"></use>
           </g>
          </g>
          <g data-mml-node="mo" transform="translate(3574.3,0)">
           <use data-c="2B" xlink:href="#MJX-2-TEX-N-2B"></use>
          </g>
          <g data-mml-node="msub" transform="translate(4574.5,0)">
           <g data-mml-node="mi">
            <use data-c="1D45D" xlink:href="#MJX-2-TEX-I-1D45D"></use>
           </g>
           <g data-mml-node="mi" transform="translate(536,-150) scale(0.707)">
            <use data-c="1D44F" xlink:href="#MJX-2-TEX-I-1D44F"></use>
           </g>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msup><mi>p</mi><mo data-mjx-alternate="1">′</mo></msup><mo>:=</mo><msub>
          <mi>p</mi>
          <mi>a</mi>
         </msub><mo>+</mo><msub>
          <mi>p</mi>
          <mi>b</mi>
         </msub>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span> <br><span md-src-pos="2127..2164">with the linearity of elliptic curves</span> <br><span class="math" inline="true" md-src-pos="2169..2186"><mjx-container class="MathJax CtxtMenu_Attached_0"
                                                                                                                                                                                         jax="SVG" tabindex="0"
                                                                                                                                                                                         ctxtmenu_counter="2"
                                                                                                                                                                                         style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="10.648ex" height="2.156ex" role="img" focusable="false" viewBox="0 -759 4706.4 953" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: -0.439ex;">
        <defs>
         <path id="MJX-3-TEX-I-1D443"
               d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path>
         <path id="MJX-3-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
         <path id="MJX-3-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path>
         <path id="MJX-3-TEX-I-1D45D"
               d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path>
         <path id="MJX-3-TEX-N-22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z"></path>
         <path id="MJX-3-TEX-I-1D43A"
               d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q492 659 471 656T418 643T357 615T294 567T236 496T189 394T158 260Q156 242 156 221Q156 173 170 136T206 79T256 45T308 28T353 24Q407 24 452 47T514 106Q517 114 529 161T541 214Q541 222 528 224T468 227H431Q425 233 425 235T427 254Q431 267 437 273H454Q494 271 594 271Q634 271 659 271T695 272T707 272Q721 272 721 263Q721 261 719 249Q714 230 709 228Q706 227 694 227Q674 227 653 224Q646 221 643 215T629 164Q620 131 614 108Q589 6 586 3Q584 1 581 1Q571 1 553 21T530 52Q530 53 528 52T522 47Q448 -22 322 -22Q201 -22 126 55T50 252Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="msup">
           <g data-mml-node="mi">
            <use data-c="1D443" xlink:href="#MJX-3-TEX-I-1D443"></use>
           </g>
           <g data-mml-node="mo" transform="translate(839.5,363) scale(0.707)">
            <use data-c="2032" xlink:href="#MJX-3-TEX-V-2032"></use>
           </g>
          </g>
          <g data-mml-node="mo" transform="translate(1361.7,0)">
           <use data-c="3D" xlink:href="#MJX-3-TEX-N-3D"></use>
          </g>
          <g data-mml-node="msup" transform="translate(2417.5,0)">
           <g data-mml-node="mi">
            <use data-c="1D45D" xlink:href="#MJX-3-TEX-I-1D45D"></use>
           </g>
           <g data-mml-node="mo" transform="translate(536,363) scale(0.707)">
            <use data-c="2032" xlink:href="#MJX-3-TEX-V-2032"></use>
           </g>
          </g>
          <g data-mml-node="mo" transform="translate(3420.1,0)">
           <use data-c="22C5" xlink:href="#MJX-3-TEX-N-22C5"></use>
          </g>
          <g data-mml-node="mi" transform="translate(3920.4,0)">
           <use data-c="1D43A" xlink:href="#MJX-3-TEX-I-1D43A"></use>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msup><mi>P</mi><mo data-mjx-alternate="1">′</mo></msup><mo>=</mo><msup><mi>p</mi><mo data-mjx-alternate="1">′</mo></msup><mo>⋅</mo><mi>G</mi>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span></p>
    </blockquote>
    <p md-src-pos="2188..2418"><span md-src-pos="2188..2211">this effectively means,</span> <span md-src-pos="2212..2258">that when Alice passes her private key to Bob,</span> <span md-src-pos="2259..2295">he can calculate the private key for</span>
        <span class="math" inline="true" md-src-pos="2296..2300"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="3" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="2.452ex" height="1.717ex" role="img" focusable="false" viewBox="0 -759 1083.9 759" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: 0px;">
       <defs>
        <path id="MJX-4-TEX-I-1D443"
              d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path>
        <path id="MJX-4-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msup">
          <g data-mml-node="mi">
           <use data-c="1D443" xlink:href="#MJX-4-TEX-I-1D443"></use>
          </g>
          <g data-mml-node="mo" transform="translate(839.5,363) scale(0.707)">
           <use data-c="2032" xlink:href="#MJX-4-TEX-V-2032"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msup><mi>P</mi><mo data-mjx-alternate="1">′</mo></msup>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="2301..2380">and therefore has the private key for spending the multisig-output as he wants.</span> <span md-src-pos="2381..2408">So he has full control over</span> <span
                md-src-pos="2409..2418">the UTXO.</span></p>
    <p md-src-pos="2420..2871"><span md-src-pos="2420..2626">So the Single transaction of the Bisq trade will have all outputs secured by a pay to public key hash and the transfer of ownership will be conducted by passing the private key from one person to the other.</span>
        <span md-src-pos="2627..2640">Note that the</span> <span md-src-pos="2641..2692">SingleTx will have 2 outputs constructed like this,</span> <span md-src-pos="2693..2764">one output will be owned by the person which gets only the deposit back</span>
        (<span md-src-pos="2766..2776">the seller</span>) <span md-src-pos="2778..2826">and the other output will be owned by the buyer,</span> <span md-src-pos="2827..2858">which gets the trade amount and</span> <span
                md-src-pos="2859..2871">the deposit.</span></p>
    <p md-src-pos="2873..3551"><span md-src-pos="2873..2925">Once the transaction is confirmed on the blockchain,</span> <span md-src-pos="2926..2961">the out-of-bands payment can begin.</span> <span
            md-src-pos="2962..2995">This is usually the fiat payment.</span> <span md-src-pos="2996..3030">Once the fiat payment is received,</span> <span md-src-pos="3031..3048">the Seller of BTC</span> (<span
            md-src-pos="3050..3055">Alice</span>) <span md-src-pos="3057..3082">will confirm the payment.</span> <span md-src-pos="3083..3109">Alice sends her secret key</span> <span class="math" inline="true"
                                                                                                                                                                                       md-src-pos="3110..3115"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="4" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="2.172ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 960.1 636" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.439ex;">
       <defs>
        <path id="MJX-5-TEX-I-1D45D"
              d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path>
        <path id="MJX-5-TEX-I-1D44E"
              d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msub">
          <g data-mml-node="mi">
           <use data-c="1D45D" xlink:href="#MJX-5-TEX-I-1D45D"></use>
          </g>
          <g data-mml-node="mi" transform="translate(536,-150) scale(0.707)">
           <use data-c="1D44E" xlink:href="#MJX-5-TEX-I-1D44E"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mi>p</mi>
         <mi>a</mi>
        </msub>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="3116..3123">to Bob.</span> <span md-src-pos="3124..3142">As stated earlier,</span> <span md-src-pos="3143..3209">the secret key must be generated independent of other secret keys.</span>
        <span md-src-pos="3210..3294">Modern HD Wallets have a dependency of secret keys among them and revealing a secret</span> <span
                md-src-pos="3295..3353">key would reveal information about the other keys as well.</span> <span md-src-pos="3354..3425">This puts some burden on the wallet which can be used in this scenario.</span>
        (<span md-src-pos="3427..3480">Although random keys are not anything new to wallets,</span> <span md-src-pos="3481..3502">but the wallets needs</span> <span md-src-pos="3503..3550">to keep track of a randomly created secret key.</span>)
    </p>
    <p md-src-pos="3553..4118"><span md-src-pos="3553..3597">Bob now has both secret keys and can compute</span> <span class="math" inline="true" md-src-pos="3598..3602"><mjx-container class="MathJax CtxtMenu_Attached_0"
                                                                                                                                                                                         jax="SVG" tabindex="0"
                                                                                                                                                                                         ctxtmenu_counter="5"
                                                                                                                                                                                         style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.766ex" height="2.156ex" role="img" focusable="false" viewBox="0 -759 780.5 953" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.439ex;">
       <defs>
        <path id="MJX-6-TEX-I-1D45D"
              d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path>
        <path id="MJX-6-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msup">
          <g data-mml-node="mi">
           <use data-c="1D45D" xlink:href="#MJX-6-TEX-I-1D45D"></use>
          </g>
          <g data-mml-node="mo" transform="translate(536,363) scale(0.707)">
           <use data-c="2032" xlink:href="#MJX-6-TEX-V-2032"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msup><mi>p</mi><mo data-mjx-alternate="1">′</mo></msup>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span><span md-src-pos="3602..3603">,</span> <span md-src-pos="3604..3695">therefore he has full control over the funds in the multisig transaction of the Bisq trade.</span> <span
            md-src-pos="3696..3701">Also,</span> <span md-src-pos="3702..3742">since he kept his secret key to himself,</span> <span md-src-pos="3743..3770">he knows that Alice can not</span> <span
            md-src-pos="3771..3805">control the funds of the multisig.</span> <span md-src-pos="3806..3849">This basically puts him into the situation,</span> <span md-src-pos="3850..3863">that he doesn</span>'<span
            md-src-pos="3864..3935">t need to make a new transaction to send the funds out of the multisig.</span> <span md-src-pos="3936..3989">Bob can leave the funds in the multisig and spent the</span> <span
            md-src-pos="3990..4031">funds whenever and for whatever he wants,</span> <span md-src-pos="4032..4118">because he has the full private key to the funds and can sign any transaction with it.</span></p>
    <h2 id="diagram-view-of-the-single-transaction" md-src-pos="4120..4161">Diagram view of the Single Transaction</h2>
    <p md-src-pos="4163..4202"><img src="http://localhost:63342/markdownPreview/2055734657/concept/TxOverview.png?_ijt=68g9bclcpm3bv2c3t2rnl8oc74" alt="Transaction Overview" __idea-generated="true"
                                    md-src-pos="4163..4202" data-original-src="concept/TxOverview.png"></p>
    <h3 id="privacy" md-src-pos="4204..4215">privacy</h3>
    <p md-src-pos="4217..4584"><span md-src-pos="4217..4269">The happy path was constructed with privacy in mind.</span> <span md-src-pos="4270..4321">One taproot transaction with script-less multisigs.</span> <span
            md-src-pos="4322..4365">The transaction has 2 inputs and 4 outputs,</span> <span md-src-pos="4366..4392">which is not very typical,</span> <span md-src-pos="4393..4415">but also not uncommon.</span> <span
            md-src-pos="4416..4424">However,</span> <span md-src-pos="4425..4433">it doesn</span>'<span md-src-pos="4434..4475">t have a script based spending condition,</span> <span md-src-pos="4476..4499">only normal key-spends.</span>
        <span md-src-pos="4500..4535">That still gives it a good privacy,</span> <span md-src-pos="4536..4584">as taproot transaction are very common nowadays.</span></p>
    <h3 id="side-note-use-of-normal-segwit-v0-transactions" md-src-pos="4586..4637">side note: use of normal segwit v0 transactions</h3>
    <p md-src-pos="4639..5636"><span md-src-pos="4639..4672">If privacy would not be an issue,</span> <span md-src-pos="4673..4746">then the transaction for the happy path could be constructed differently.</span> <span
            md-src-pos="4747..4760">In that case,</span> <span md-src-pos="4761..4801">it could be made with segwit v0 as well.</span> <span md-src-pos="4802..4859">Instead of the scriptless multisig we could have a script</span>
        <span md-src-pos="4860..4869">multisig.</span> <span md-src-pos="4870..4961">And instead of passing the private key to transfer the ownership of the scritless multisig,</span> <span md-src-pos="4962..5024">Bob could send a signature for his Public Key in the MultiSig.</span>
        <span md-src-pos="5025..5058">This Signature would need to have</span> <code md-src-pos="5059..5094">SIGHASH_NONE || SIGHASH_ALLCANPAY</code><span md-src-pos="5094..5095">.</span> <span md-src-pos="5096..5172">With this sighash type the signature will only verify against the own input,</span>
        <span md-src-pos="5173..5240">no output and no other inputs will be part of the message to check.</span> <span md-src-pos="5241..5279">Practically is this like a blank check</span> <span md-src-pos="5280..5299">for the other side,</span>
        <span md-src-pos="5300..5343">it enables Alice to create any transaction,</span> <span md-src-pos="5344..5408">she just needs to sign her pub key in the multisig with her key.</span> <span
                md-src-pos="5409..5441">Alice must sign her pub key with</span> <code md-src-pos="5442..5455">SIGHASH_ALL</code><span md-src-pos="5455..5456">.</span> <span md-src-pos="5457..5496">At least one Signature in a transaction</span>
        <span md-src-pos="5497..5510">needs to have</span> <code md-src-pos="5511..5524">SIGHASH_ALL</code><span md-src-pos="5524..5525">,</span> <span md-src-pos="5526..5618">otherwise the transaction could be changed by anybody seeing the transaction in the mempool,</span>
        <span md-src-pos="5619..5636">before its mined.</span></p>
    <h2 id="swap-transaction" md-src-pos="5638..5657">Swap transaction</h2>
    <p md-src-pos="5659..6491"><span md-src-pos="5659..5673">In the section</span> '<span md-src-pos="5675..5685">Happy Path</span>' <span md-src-pos="5687..5730">I described only one part of the UTXO swap,</span> <span
            md-src-pos="5731..5770">basically the exchange of private keys.</span> <span md-src-pos="5771..5779">However,</span> <span md-src-pos="5780..5831">the seller deposits the trade amount and a deposit,</span>
        <span md-src-pos="5832..5868">the buyer deposits only a deposit as</span> <span md-src-pos="5869..5876">escrow.</span> <span md-src-pos="5877..5892">After the deal,</span> <span md-src-pos="5893..6005">the buyer should have control over a deposit and the buyer shall have sole control over the funds and a deposit,</span>
        <span md-src-pos="6006..6066">assuming the deposit from both parties have the same amount.</span> <span md-src-pos="6067..6087">This means they need</span> <span md-src-pos="6088..6167">to exchange control for the respective utxos at the same time in an atomic way.</span>
        <span md-src-pos="6168..6217">If the seller sends the private key to the buyer,</span> <span md-src-pos="6218..6247">but the buyer stays inactive,</span> <span md-src-pos="6248..6297">then the seller will not get access to a deposit.</span>
        <span md-src-pos="6298..6301">The</span> <span md-src-pos="6302..6344">deposit for him cannot be moved by anyone,</span> <span md-src-pos="6345..6382">because he still has one of two keys,</span> <span
                md-src-pos="6383..6410">but he cant move it either.</span> <span md-src-pos="6411..6491">How do Alice and Bob exchange their private keys for the UTXOs in an atomic way?</span></p>
    <p md-src-pos="6493..7265"><span md-src-pos="6493..6530">Before exchanging the private key for</span> <span class="math" inline="true" md-src-pos="6531..6535"><mjx-container class="MathJax CtxtMenu_Attached_0"
                                                                                                                                                                                  jax="SVG" tabindex="0"
                                                                                                                                                                                  ctxtmenu_counter="6"
                                                                                                                                                                                  style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="2.452ex" height="1.717ex" role="img" focusable="false" viewBox="0 -759 1083.9 759" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: 0px;">
       <defs>
        <path id="MJX-7-TEX-I-1D443"
              d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path>
        <path id="MJX-7-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msup">
          <g data-mml-node="mi">
           <use data-c="1D443" xlink:href="#MJX-7-TEX-I-1D443"></use>
          </g>
          <g data-mml-node="mo" transform="translate(839.5,363) scale(0.707)">
           <use data-c="2032" xlink:href="#MJX-7-TEX-V-2032"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msup><mi>P</mi><mo data-mjx-alternate="1">′</mo></msup>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="6536..6539">and</span> <span class="math" inline="true" md-src-pos="6540..6544"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0"
                                                                                                                                              ctxtmenu_counter="7" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="2.417ex" height="2.156ex" role="img" focusable="false" viewBox="0 -759 1068.5 953" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.439ex;">
       <defs>
        <path id="MJX-8-TEX-I-1D444"
              d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path>
        <path id="MJX-8-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msup">
          <g data-mml-node="mi">
           <use data-c="1D444" xlink:href="#MJX-8-TEX-I-1D444"></use>
          </g>
          <g data-mml-node="mo" transform="translate(824,363) scale(0.707)">
           <use data-c="2032" xlink:href="#MJX-8-TEX-V-2032"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msup><mi>Q</mi><mo data-mjx-alternate="1">′</mo></msup>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span><span md-src-pos="6544..6545">,</span> <span md-src-pos="6546..6591">Alice and Bob need to sign a swap transaction</span> (<code md-src-pos="6593..6601">SwapTx</code>) <span
            md-src-pos="6603..6612">for Alice</span> (<span md-src-pos="6614..6624">the Seller</span>) <span md-src-pos="6626..6659">in a way that when Alice uses the</span> <code
            md-src-pos="6660..6668">SwapTx</code><span md-src-pos="6668..6669">,</span> <span md-src-pos="6670..6686">then she reveals</span> <span md-src-pos="6687..6744">information to Bob such that he can spend Output 0 of the</span>
        <code md-src-pos="6745..6756">DepositTx</code><span md-src-pos="6756..6757">,</span> <span md-src-pos="6758..6776">which is locked by</span> <span class="math" inline="true" md-src-pos="6777..6781"><mjx-container
                class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="8" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="2.452ex" height="1.717ex" role="img" focusable="false" viewBox="0 -759 1083.9 759" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: 0px;">
       <defs>
        <path id="MJX-9-TEX-I-1D443"
              d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path>
        <path id="MJX-9-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msup">
          <g data-mml-node="mi">
           <use data-c="1D443" xlink:href="#MJX-9-TEX-I-1D443"></use>
          </g>
          <g data-mml-node="mo" transform="translate(839.5,363) scale(0.707)">
           <use data-c="2032" xlink:href="#MJX-9-TEX-V-2032"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msup><mi>P</mi><mo data-mjx-alternate="1">′</mo></msup>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span><span md-src-pos="6781..6782">.</span> <span md-src-pos="6783..6801">Bob constructs the</span> <code md-src-pos="6802..6810">SwapTx</code> <span md-src-pos="6811..6839">such that it sends the buyer</span>
        (<span md-src-pos="6841..6844">his</span>) <span md-src-pos="6846..6870">deposit to Alice Wallet.</span> <span md-src-pos="6871..6902">Bobs prepares the signature for</span> <code
                md-src-pos="6903..6911">SwapTx</code> <span md-src-pos="6912..6978">such that Alice must reveal a secret to Bob to use that signature.</span> <span md-src-pos="6979..6991">Technically,</span> <span
                md-src-pos="6992..7033">this is done through adaptive signatures.</span> <span md-src-pos="7034..7094">The secret Alice must pass to Bob for using the signature is</span> <span class="math" inline="true"
                                                                                                                                                                                                 md-src-pos="7095..7100"><mjx-container
                class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="2.172ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 960.1 636" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.439ex;">
       <defs>
        <path id="MJX-10-TEX-I-1D45D"
              d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path>
        <path id="MJX-10-TEX-I-1D44E"
              d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msub">
          <g data-mml-node="mi">
           <use data-c="1D45D" xlink:href="#MJX-10-TEX-I-1D45D"></use>
          </g>
          <g data-mml-node="mi" transform="translate(536,-150) scale(0.707)">
           <use data-c="1D44E" xlink:href="#MJX-10-TEX-I-1D44E"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mi>p</mi>
         <mi>a</mi>
        </msub>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span><span md-src-pos="7100..7101">.</span> <span md-src-pos="7102..7115">Since Bob has</span> <span class="math" inline="true" md-src-pos="7116..7121"><mjx-container
                class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="10" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="2.012ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 889.3 636" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.439ex;">
       <defs>
        <path id="MJX-11-TEX-I-1D45D"
              d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path>
        <path id="MJX-11-TEX-I-1D44F"
              d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msub">
          <g data-mml-node="mi">
           <use data-c="1D45D" xlink:href="#MJX-11-TEX-I-1D45D"></use>
          </g>
          <g data-mml-node="mi" transform="translate(536,-150) scale(0.707)">
           <use data-c="1D44F" xlink:href="#MJX-11-TEX-I-1D44F"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mi>p</mi>
         <mi>b</mi>
        </msub>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="7122..7130">already,</span> <span md-src-pos="7131..7160">that enables him to calculate</span> <span class="math" inline="true" md-src-pos="7161..7177"><mjx-container
                class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="11" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="11.733ex" height="2.156ex" role="img" focusable="false" viewBox="0 -759 5185.9 953" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.439ex;">
       <defs>
        <path id="MJX-12-TEX-I-1D45D"
              d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path>
        <path id="MJX-12-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
        <path id="MJX-12-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path>
        <path id="MJX-12-TEX-I-1D44E"
              d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
        <path id="MJX-12-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path>
        <path id="MJX-12-TEX-I-1D44F"
              d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msup">
          <g data-mml-node="mi">
           <use data-c="1D45D" xlink:href="#MJX-12-TEX-I-1D45D"></use>
          </g>
          <g data-mml-node="mo" transform="translate(536,363) scale(0.707)">
           <use data-c="2032" xlink:href="#MJX-12-TEX-V-2032"></use>
          </g>
         </g>
         <g data-mml-node="mo" transform="translate(1058.2,0)">
          <use data-c="3D" xlink:href="#MJX-12-TEX-N-3D"></use>
         </g>
         <g data-mml-node="msub" transform="translate(2114,0)">
          <g data-mml-node="mi">
           <use data-c="1D45D" xlink:href="#MJX-12-TEX-I-1D45D"></use>
          </g>
          <g data-mml-node="mi" transform="translate(536,-150) scale(0.707)">
           <use data-c="1D44E" xlink:href="#MJX-12-TEX-I-1D44E"></use>
          </g>
         </g>
         <g data-mml-node="mo" transform="translate(3296.3,0)">
          <use data-c="2B" xlink:href="#MJX-12-TEX-N-2B"></use>
         </g>
         <g data-mml-node="msub" transform="translate(4296.5,0)">
          <g data-mml-node="mi">
           <use data-c="1D45D" xlink:href="#MJX-12-TEX-I-1D45D"></use>
          </g>
          <g data-mml-node="mi" transform="translate(536,-150) scale(0.707)">
           <use data-c="1D44F" xlink:href="#MJX-12-TEX-I-1D44F"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msup><mi>p</mi><mo data-mjx-alternate="1">′</mo></msup><mo>=</mo><msub>
         <mi>p</mi>
         <mi>a</mi>
        </msub><mo>+</mo><msub>
         <mi>p</mi>
         <mi>b</mi>
        </msub>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span><span md-src-pos="7177..7178">,</span> <span md-src-pos="7179..7206">which is the secret key for</span> <span class="math" inline="true" md-src-pos="7207..7211"><mjx-container
                class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="12" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="2.452ex" height="1.717ex" role="img" focusable="false" viewBox="0 -759 1083.9 759" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: 0px;">
       <defs>
        <path id="MJX-13-TEX-I-1D443"
              d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path>
        <path id="MJX-13-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msup">
          <g data-mml-node="mi">
           <use data-c="1D443" xlink:href="#MJX-13-TEX-I-1D443"></use>
          </g>
          <g data-mml-node="mo" transform="translate(839.5,363) scale(0.707)">
           <use data-c="2032" xlink:href="#MJX-13-TEX-V-2032"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msup><mi>P</mi><mo data-mjx-alternate="1">′</mo></msup>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="7212..7265">so he can spend the sellers deposit and trade amount.</span></p>
    <p md-src-pos="7267..7701"><span md-src-pos="7267..7294">Details can be found in the</span> <a href="file:/mnt/work/extra/dev/bisq-musig/concept/MuSig2adaptor-rust.md" md-src-pos="7295..7371">write-up of how adaptor
        signatures work with MuSig2</a><span md-src-pos="7371..7372">.</span> <span md-src-pos="7373..7414">In sum this is a secret atomic UTXO swap.</span> <span md-src-pos="7415..7434">After preparing the</span> <code
            md-src-pos="7435..7443">SwapTx</code><span md-src-pos="7443..7444">,</span> <span md-src-pos="7445..7478">Alice can send Bob the secret key</span> <span class="math" inline="true" md-src-pos="7479..7484"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="13" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="2.172ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 960.1 636" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.439ex;">
       <defs>
        <path id="MJX-14-TEX-I-1D45D"
              d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path>
        <path id="MJX-14-TEX-I-1D44E"
              d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msub">
          <g data-mml-node="mi">
           <use data-c="1D45D" xlink:href="#MJX-14-TEX-I-1D45D"></use>
          </g>
          <g data-mml-node="mi" transform="translate(536,-150) scale(0.707)">
           <use data-c="1D44E" xlink:href="#MJX-14-TEX-I-1D44E"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mi>p</mi>
         <mi>a</mi>
        </msub>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span><span md-src-pos="7484..7485">,</span> <span md-src-pos="7486..7498">if Bob doesn</span>'<span md-src-pos="7499..7505">t send</span> <span class="math" inline="true" md-src-pos="7506..7511"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="14" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="2.012ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 889.3 636" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.439ex;">
       <defs>
        <path id="MJX-15-TEX-I-1D45D"
              d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path>
        <path id="MJX-15-TEX-I-1D44F"
              d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msub">
          <g data-mml-node="mi">
           <use data-c="1D45D" xlink:href="#MJX-15-TEX-I-1D45D"></use>
          </g>
          <g data-mml-node="mi" transform="translate(536,-150) scale(0.707)">
           <use data-c="1D44F" xlink:href="#MJX-15-TEX-I-1D44F"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mi>p</mi>
         <mi>b</mi>
        </msub>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span><span md-src-pos="7511..7512">,</span> <span md-src-pos="7513..7535">then she still has the</span> <code md-src-pos="7536..7544">SwapTx</code> <span md-src-pos="7545..7552">to use.</span>
        <span md-src-pos="7553..7628">So Alice and Bob are able to exchange the keys without using a transaction,</span> <span md-src-pos="7629..7632">the</span> <code md-src-pos="7633..7641">SwapTx</code> <span
                md-src-pos="7642..7678">only serves as fallback if Bob doesn</span>'<span md-src-pos="7679..7701">t follow the protocol.</span></p>
    <p md-src-pos="7703..7831"><span md-src-pos="7703..7785">The transfer of ownership in this protocol is basically swapping control of UTXOs,</span> <span md-src-pos="7786..7831">by exchanging private keys for the multisigs.</span>
    </p>
    <h2 id="the-alternative-paths-warning-tx" md-src-pos="7833..7869">the alternative paths, Warning Tx</h2>
    <p md-src-pos="7871..8141"><span md-src-pos="7871..7879">However,</span> <span md-src-pos="7880..7925">sometimes one party is uncooperative or doesn</span>'<span md-src-pos="7926..7943">t respond at all.</span> <span
            md-src-pos="7944..8006">For these cases we are preparing with pre-signed transactions.</span> <span md-src-pos="8007..8048">The first one is the Warning transaction.</span> <span md-src-pos="8049..8077">There is one transaction for</span>
        <span md-src-pos="8078..8100">Alice and one for Bob.</span> <span md-src-pos="8101..8123">They are very similar,</span> <span md-src-pos="8124..8141">but not the same.</span></p>
    <p md-src-pos="8143..8409"><span md-src-pos="8143..8158">Here is how the</span> <code md-src-pos="8159..8176">WarningTx Alice</code> <span md-src-pos="8177..8193">would look like.</span> <span
            md-src-pos="8194..8196">It</span>'<span md-src-pos="8197..8205">s called</span> <code md-src-pos="8206..8223">WarningTx Alice</code><span md-src-pos="8223..8224">,</span> <span md-src-pos="8225..8251">because Alice can post it.</span>
        <span md-src-pos="8252..8261">Alice won</span>'<span md-src-pos="8262..8279">t be able to post</span> <code md-src-pos="8280..8295">WarningTx Bob</code><span md-src-pos="8295..8296">.</span> <span
                md-src-pos="8297..8359">The inputs will be the two outputs of the SingleTx from above,</span> <span md-src-pos="8360..8409">which include the trade amount and both deposits.</span></p>
    <p md-src-pos="8411..8420"><span md-src-pos="8411..8419">Output 0</span>:</p>
    <ul md-src-pos="8422..8782">
        <li md-src-pos="8422..8464">amount: Seller deposit and trade amount.</li>
        <li md-src-pos="8465..8782">Key spend: <span class="math" inline="true" md-src-pos="8478..8482"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="15"
                                                                                                                       style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="2.452ex" height="1.717ex" role="img" focusable="false" viewBox="0 -759 1083.9 759" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: 0px;">
        <defs>
         <path id="MJX-16-TEX-I-1D443"
               d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path>
         <path id="MJX-16-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="msup">
           <g data-mml-node="mi">
            <use data-c="1D443" xlink:href="#MJX-16-TEX-I-1D443"></use>
           </g>
           <g data-mml-node="mo" transform="translate(839.5,363) scale(0.707)">
            <use data-c="2032" xlink:href="#MJX-16-TEX-V-2032"></use>
           </g>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msup><mi>P</mi><mo data-mjx-alternate="1">′</mo></msup>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span> In case that Alice has given Bob the 2nd secret key for <span class="math" inline="true" md-src-pos="8539..8543"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0"
                                                                                                                                                              ctxtmenu_counter="16" style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="2.452ex" height="1.717ex" role="img" focusable="false" viewBox="0 -759 1083.9 759" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: 0px;">
        <defs>
         <path id="MJX-17-TEX-I-1D443"
               d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path>
         <path id="MJX-17-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="msup">
           <g data-mml-node="mi">
            <use data-c="1D443" xlink:href="#MJX-17-TEX-I-1D443"></use>
           </g>
           <g data-mml-node="mo" transform="translate(839.5,363) scale(0.707)">
            <use data-c="2032" xlink:href="#MJX-17-TEX-V-2032"></use>
           </g>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msup><mi>P</mi><mo data-mjx-alternate="1">′</mo></msup>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span> already, but still posting this <code md-src-pos="8576..8593">WarningTx Alice</code>, then Bob is able to immediately transfer the output 0 to his wallet by using the secret key for <span
                class="math" inline="true" md-src-pos="8693..8697"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="17" style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="2.452ex" height="1.717ex" role="img" focusable="false" viewBox="0 -759 1083.9 759" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: 0px;">
        <defs>
         <path id="MJX-18-TEX-I-1D443"
               d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path>
         <path id="MJX-18-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="msup">
           <g data-mml-node="mi">
            <use data-c="1D443" xlink:href="#MJX-18-TEX-I-1D443"></use>
           </g>
           <g data-mml-node="mo" transform="translate(839.5,363) scale(0.707)">
            <use data-c="2032" xlink:href="#MJX-18-TEX-V-2032"></use>
           </g>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msup><mi>P</mi><mo data-mjx-alternate="1">′</mo></msup>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span> as key spend. Note this should not happen, as it has only disadvantages for Alice.
        </li>
    </ul>
    <p md-src-pos="8784..9077"><span md-src-pos="8784..8792">Output 1</span>: <span md-src-pos="8794..8860">An anchor output with key spend from a public key of Alice Wallet.</span> <span md-src-pos="8861..8890">Since we are constructing the</span>
        <code md-src-pos="8891..8908">WarningTx Alice</code> <span md-src-pos="8909..8920">beforehand,</span> <span md-src-pos="8921..8927">we won</span>'<span md-src-pos="8928..9007">t know which is a reasonable fee rate at the time the transaction is broadcast.</span>
        <span md-src-pos="9008..9077">So Alice can construct a CPFP transaction to pay for additional fees.</span></p>
    <h3 id="analysis-of-the-alternative-paths-while-swapping-utxos" md-src-pos="9079..9137">analysis of the alternative paths while swapping UTXOs</h3>
    <p md-src-pos="9139..9837"><span md-src-pos="9139..9167">Above we saw the happy path,</span> <span md-src-pos="9168..9201">if everybody behaves as expected.</span> <span md-src-pos="9202..9241">Having those steps setup and explained,</span>
        <span md-src-pos="9242..9309">gives us now the possibility to analyse what can possibly go wrong.</span> <span md-src-pos="9310..9364">Since swapping the UTXOs happens after initialization,</span> <span
                md-src-pos="9365..9441">all transactions seen in the diagram above are already setup and pre-signed.</span> <span md-src-pos="9442..9446">Even</span> <code md-src-pos="9447..9455">SwapTx</code> <span
                md-src-pos="9456..9474">is already signed,</span> <span md-src-pos="9475..9533">which gives Alice the possibility of using it prematurely.</span> <span md-src-pos="9534..9591">If she uses it before the fiat payment actually happened,</span>
        <span md-src-pos="9592..9607">she can get Bob</span>'<span md-src-pos="9608..9618">s deposit.</span> <span md-src-pos="9619..9654">But with exposing the signature for</span> <code
                md-src-pos="9655..9663">SwapTx</code> <span md-src-pos="9664..9722">she enables Bob to get the trade amount and Alice deposit,</span> <span md-src-pos="9723..9756">which of course is a bad bargain.</span>
        <span md-src-pos="9757..9772">Only the Seller</span> (<span md-src-pos="9774..9779">Alice</span>) <span md-src-pos="9781..9786">has a</span> <code md-src-pos="9787..9795">SwapTx</code><span
                md-src-pos="9795..9796">.</span> <span md-src-pos="9797..9836">Now what can happen while the UTXO swap</span>:</p>
    <ol md-src-pos="9839..10752">
        <li md-src-pos="9839..10055">If Bob is unresponsive at this step, Alice can post the <code md-src-pos="9898..9915">WarningTx Alice</code> and will get her money back (see below how exactly) or use the <code
                md-src-pos="9979..9987">SwapTx</code> to get her money directly (if the fiat transaction was successful).
        </li>
        <li md-src-pos="10056..10118">If Alice is unresponsive, Bob can post the <code md-src-pos="10102..10117">WarningTx Bob</code>.</li>
        <li md-src-pos="10119..10274">If Alice sees that the fiat payment arrived, Alice now begins with sending <span class="math" inline="true" md-src-pos="10197..10202"><mjx-container
                class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="18" style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="2.172ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 960.1 636" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: -0.439ex;">
        <defs>
         <path id="MJX-19-TEX-I-1D45D"
               d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path>
         <path id="MJX-19-TEX-I-1D44E"
               d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="msub">
           <g data-mml-node="mi">
            <use data-c="1D45D" xlink:href="#MJX-19-TEX-I-1D45D"></use>
           </g>
           <g data-mml-node="mi" transform="translate(536,-150) scale(0.707)">
            <use data-c="1D44E" xlink:href="#MJX-19-TEX-I-1D44E"></use>
           </g>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msub>
          <mi>p</mi>
          <mi>a</mi>
         </msub>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span> to Bob, which enables him to unlock the seller deposit and trade funds.
        </li>
        <li md-src-pos="10275..10752">Bob can now spend <span class="math" inline="true" md-src-pos="10296..10300"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="19"
                                                                                                                                  style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="2.452ex" height="1.717ex" role="img" focusable="false" viewBox="0 -759 1083.9 759" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: 0px;">
        <defs>
         <path id="MJX-20-TEX-I-1D443"
               d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path>
         <path id="MJX-20-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="msup">
           <g data-mml-node="mi">
            <use data-c="1D443" xlink:href="#MJX-20-TEX-I-1D443"></use>
           </g>
           <g data-mml-node="mo" transform="translate(839.5,363) scale(0.707)">
            <use data-c="2032" xlink:href="#MJX-20-TEX-V-2032"></use>
           </g>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msup><mi>P</mi><mo data-mjx-alternate="1">′</mo></msup>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span> and don't care for sending Alice <span class="math" inline="true" md-src-pos="10334..10339"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="20"
                                                                                                                                         style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="1.883ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 832.3 636" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: -0.439ex;">
        <defs>
         <path id="MJX-21-TEX-I-1D45E"
               d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path>
         <path id="MJX-21-TEX-I-1D44F"
               d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="msub">
           <g data-mml-node="mi">
            <use data-c="1D45E" xlink:href="#MJX-21-TEX-I-1D45E"></use>
           </g>
           <g data-mml-node="mi" transform="translate(479,-150) scale(0.707)">
            <use data-c="1D44F" xlink:href="#MJX-21-TEX-I-1D44F"></use>
           </g>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msub>
          <mi>q</mi>
          <mi>b</mi>
         </msub>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span> for her to get her deposit. Alice cannot send <code md-src-pos="10386..10403">WarningTX Alice</code> at this point, because Bob has already <span class="math" inline="true"
                                                                                                                                                                                md-src-pos="10446..10450"><mjx-container
                class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="21" style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="2.452ex" height="1.717ex" role="img" focusable="false" viewBox="0 -759 1083.9 759" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: 0px;">
        <defs>
         <path id="MJX-22-TEX-I-1D443"
               d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path>
         <path id="MJX-22-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="msup">
           <g data-mml-node="mi">
            <use data-c="1D443" xlink:href="#MJX-22-TEX-I-1D443"></use>
           </g>
           <g data-mml-node="mo" transform="translate(839.5,363) scale(0.707)">
            <use data-c="2032" xlink:href="#MJX-22-TEX-V-2032"></use>
           </g>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msup><mi>P</mi><mo data-mjx-alternate="1">′</mo></msup>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span> and could get all funds out of <code md-src-pos="10482..10499">WarningTx Alice</code>.
            <ol md-src-pos="10504..10752">
                <li md-src-pos="10504..10555">Alice can still use <code md-src-pos="10528..10536">SwapTx</code>to get her deposit.</li>
                <li md-src-pos="10559..10752">If Bob broadcasts his <code md-src-pos="10585..10600">WarningTx Bob</code> before Alice <code md-src-pos="10614..10622">SwapTx</code>, then Alice can still broadcast <code
                        md-src-pos="10655..10673">RedirectTx Alice</code>, because Bob does not have the secret key for <span class="math" inline="true" md-src-pos="10720..10724"><mjx-container
                        class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="22" style="position: relative;">
         <svg xmlns="http://www.w3.org/2000/svg" width="2.417ex" height="2.156ex" role="img" focusable="false" viewBox="0 -759 1068.5 953" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
              style="vertical-align: -0.439ex;">
          <defs>
           <path id="MJX-23-TEX-I-1D444"
                 d="M399 -80Q399 -47 400 -30T402 -11V-7L387 -11Q341 -22 303 -22Q208 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435Q740 255 592 107Q529 47 461 16L444 8V3Q444 2 449 -24T470 -66T516 -82Q551 -82 583 -60T625 -3Q631 11 638 11Q647 11 649 2Q649 -6 639 -34T611 -100T557 -165T481 -194Q399 -194 399 -87V-80ZM636 468Q636 523 621 564T580 625T530 655T477 665Q429 665 379 640Q277 591 215 464T153 216Q153 110 207 59Q231 38 236 38V46Q236 86 269 120T347 155Q372 155 390 144T417 114T429 82T435 55L448 64Q512 108 557 185T619 334T636 468ZM314 18Q362 18 404 39L403 49Q399 104 366 115Q354 117 347 117Q344 117 341 117T337 118Q317 118 296 98T274 52Q274 18 314 18Z"></path>
           <path id="MJX-23-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
          </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
           <g data-mml-node="math">
            <g data-mml-node="msup">
             <g data-mml-node="mi">
              <use data-c="1D444" xlink:href="#MJX-23-TEX-I-1D444"></use>
             </g>
             <g data-mml-node="mo" transform="translate(824,363) scale(0.707)">
              <use data-c="2032" xlink:href="#MJX-23-TEX-V-2032"></use>
             </g>
            </g>
           </g>
          </g>
         </svg>
         <mjx-assistive-mml unselectable="on" display="inline">
          <math xmlns="http://www.w3.org/1998/Math/MathML">
           <msup><mi>Q</mi><mo data-mjx-alternate="1">′</mo></msup>
          </math>
         </mjx-assistive-mml>
        </mjx-container></span> to empty <code md-src-pos="10734..10751">WarningTx Alice</code>.
                </li>
            </ol>
        </li>
    </ol>
    <h2 id="alternative-paths" md-src-pos="10754..10774">alternative Paths</h2>
    <p md-src-pos="10776..11109"><span md-src-pos="10776..10785">After the</span> <code md-src-pos="10786..10797">DepositTx</code> <span md-src-pos="10798..10817">has been broadcast,</span> <span
            md-src-pos="10818..10853">it may happen for different reason,</span> <span md-src-pos="10854..10923">that the protocol does not move along the happy path described above.</span> <span
            md-src-pos="10924..10983">It could be that one party is inactive or fiat payment didn</span>'<span md-src-pos="10984..11042">t happen or any reason oe of the traders is not satisfied.</span> <span
            md-src-pos="11043..11096">In that case ech trader has the possibility to post a</span> <code md-src-pos="11097..11108">WarningTx</code><span md-src-pos="11108..11109">.</span></p>
    <h3 id="warning-transaction" md-src-pos="11111..11134">Warning transaction</h3>
    <p md-src-pos="11136..11467"><span md-src-pos="11136..11139">The</span> <code md-src-pos="11140..11151">WarningTx</code> <span md-src-pos="11152..11175">has both outputs of the</span> <code md-src-pos="11176..11187">DepositTx</code>
        <span md-src-pos="11188..11197">as input,</span> <span md-src-pos="11198..11265">that means if any of the trader has spent his trade outcome already</span> (<span md-src-pos="11267..11311">and therefore the UTXO swap already happened</span>)<span
                md-src-pos="11312..11313">,</span> <span md-src-pos="11314..11322">then the</span> <code md-src-pos="11323..11334">WarningTx</code> <span md-src-pos="11335..11349">cannot be used</span> <span
                md-src-pos="11350..11358">anymore.</span> <span md-src-pos="11359..11379">As the name says the</span> <code md-src-pos="11380..11391">WarningTx</code> <span md-src-pos="11392..11428">does warn the other party about what</span>'<span
                md-src-pos="11429..11437">s ahead.</span> <span md-src-pos="11438..11467">One of three case can happen.</span></p>
    <ol md-src-pos="11469..11808">
        <li md-src-pos="11469..11769">The <code md-src-pos="11476..11493">WarningTx Alice</code> has a key spend <span class="math" inline="true" md-src-pos="11510..11514"><mjx-container
                class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="23" style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="2.204ex" height="1.767ex" role="img" focusable="false" viewBox="0 -759 974.1 781" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: -0.05ex;">
        <defs>
         <path id="MJX-24-TEX-I-1D446"
               d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path>
         <path id="MJX-24-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="msup">
           <g data-mml-node="mi">
            <use data-c="1D446" xlink:href="#MJX-24-TEX-I-1D446"></use>
           </g>
           <g data-mml-node="mo" transform="translate(729.6,363) scale(0.707)">
            <use data-c="2032" xlink:href="#MJX-24-TEX-V-2032"></use>
           </g>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msup><mi>S</mi><mo data-mjx-alternate="1">′</mo></msup>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span>. If the key swap was successful beforehand then Bob has <span class="math" inline="true" md-src-pos="11571..11583"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0"
                                                                                                                                                                ctxtmenu_counter="24" style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="11.733ex" height="2.156ex" role="img" focusable="false" viewBox="0 -759 5185.9 953" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: -0.439ex;">
        <defs>
         <path id="MJX-25-TEX-I-1D45D"
               d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path>
         <path id="MJX-25-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
         <path id="MJX-25-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path>
         <path id="MJX-25-TEX-I-1D44E"
               d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
         <path id="MJX-25-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path>
         <path id="MJX-25-TEX-I-1D44F"
               d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="msup">
           <g data-mml-node="mi">
            <use data-c="1D45D" xlink:href="#MJX-25-TEX-I-1D45D"></use>
           </g>
           <g data-mml-node="mo" transform="translate(536,363) scale(0.707)">
            <use data-c="2032" xlink:href="#MJX-25-TEX-V-2032"></use>
           </g>
          </g>
          <g data-mml-node="mo" transform="translate(1058.2,0)">
           <use data-c="3D" xlink:href="#MJX-25-TEX-N-3D"></use>
          </g>
          <g data-mml-node="msub" transform="translate(2114,0)">
           <g data-mml-node="mi">
            <use data-c="1D45D" xlink:href="#MJX-25-TEX-I-1D45D"></use>
           </g>
           <g data-mml-node="mi" transform="translate(536,-150) scale(0.707)">
            <use data-c="1D44E" xlink:href="#MJX-25-TEX-I-1D44E"></use>
           </g>
          </g>
          <g data-mml-node="mo" transform="translate(3296.3,0)">
           <use data-c="2B" xlink:href="#MJX-25-TEX-N-2B"></use>
          </g>
          <g data-mml-node="msub" transform="translate(4296.5,0)">
           <g data-mml-node="mi">
            <use data-c="1D45D" xlink:href="#MJX-25-TEX-I-1D45D"></use>
           </g>
           <g data-mml-node="mi" transform="translate(536,-150) scale(0.707)">
            <use data-c="1D44F" xlink:href="#MJX-25-TEX-I-1D44F"></use>
           </g>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msup><mi>p</mi><mo data-mjx-alternate="1">′</mo></msup><mo>=</mo><msub>
          <mi>p</mi>
          <mi>a</mi>
         </msub><mo>+</mo><msub>
          <mi>p</mi>
          <mi>b</mi>
         </msub>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span>, the secret key for <span class="math" inline="true" md-src-pos="11604..11608"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="25"
                                                                                                                            style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="2.452ex" height="1.717ex" role="img" focusable="false" viewBox="0 -759 1083.9 759" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: 0px;">
        <defs>
         <path id="MJX-26-TEX-I-1D443"
               d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path>
         <path id="MJX-26-TEX-V-2032" d="M79 43Q73 43 52 49T30 61Q30 68 85 293T146 528Q161 560 198 560Q218 560 240 545T262 501Q262 496 260 486Q259 479 173 263T84 45T79 43Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="msup">
           <g data-mml-node="mi">
            <use data-c="1D443" xlink:href="#MJX-26-TEX-I-1D443"></use>
           </g>
           <g data-mml-node="mo" transform="translate(839.5,363) scale(0.707)">
            <use data-c="2032" xlink:href="#MJX-26-TEX-V-2032"></use>
           </g>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <msup><mi>P</mi><mo data-mjx-alternate="1">′</mo></msup>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span>. He can take away all the money, both deposits and the trade amount. This is to prevent Alice using the <code md-src-pos="11716..11727">WarningTx</code> in case the happy path completed
            already.
        </li>
        <li md-src-pos="11770..11789"><code md-src-pos="11773..11789">RedirectTx Bob</code></li>
        <li md-src-pos="11790..11808"><code md-src-pos="11793..11808">ClaimTx Alice</code></li>
    </ol>
    <h3 id="redirect-transaction" md-src-pos="11810..11834">redirect transaction</h3>
    <p md-src-pos="11836..12521"><span md-src-pos="11836..11839">The</span> <code md-src-pos="11840..11856">RedirectTx Bob</code> <span md-src-pos="11857..11873">has a time delay</span> <span class="math" inline="true"
                                                                                                                                                                                                md-src-pos="11874..11879"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="26" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.804ex" height="1.756ex" role="img" focusable="false" viewBox="0 -626 797.6 776" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.339ex;">
       <defs>
        <path id="MJX-27-TEX-I-1D461"
              d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path>
        <path id="MJX-27-TEX-N-31"
              d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msub">
          <g data-mml-node="mi">
           <use data-c="1D461" xlink:href="#MJX-27-TEX-I-1D461"></use>
          </g>
          <g data-mml-node="mn" transform="translate(394,-150) scale(0.707)">
           <use data-c="31" xlink:href="#MJX-27-TEX-N-31"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mi>t</mi>
         <mn>1</mn>
        </msub>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="11880..11889">build in,</span> <span md-src-pos="11890..11931">which gives Bob some time to use Option 1</span> (<span md-src-pos="11933..11946">the key spend</span>)<span
            md-src-pos="11947..11948">.</span> <span md-src-pos="11949..11965">Note that we don</span>'<span md-src-pos="11966..11973">t use a</span> <code md-src-pos="11974..11982">OP_CSV</code> <span
            md-src-pos="11983..11990">script,</span> <span md-src-pos="11991..12047">because Alice enforces the time delay by not signing the</span> <code md-src-pos="12048..12063">RediretTx Bob</code> <span
            md-src-pos="12064..12075">if it doesn</span>'<span md-src-pos="12076..12099">t have nSequence set to</span> <span class="math" inline="true" md-src-pos="12100..12105"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="27" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.804ex" height="1.756ex" role="img" focusable="false" viewBox="0 -626 797.6 776" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.339ex;">
       <defs>
        <path id="MJX-28-TEX-I-1D461"
              d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path>
        <path id="MJX-28-TEX-N-31"
              d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msub">
          <g data-mml-node="mi">
           <use data-c="1D461" xlink:href="#MJX-28-TEX-I-1D461"></use>
          </g>
          <g data-mml-node="mn" transform="translate(394,-150) scale(0.707)">
           <use data-c="31" xlink:href="#MJX-28-TEX-N-31"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mi>t</mi>
         <mn>1</mn>
        </msub>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span><span md-src-pos="12105..12106">.</span> <span md-src-pos="12107..12115">With the</span> <code md-src-pos="12116..12132">RedirectTx Bob</code> <span md-src-pos="12133..12162">Bob can send the funds to the</span>
        <span md-src-pos="12163..12191">burning men of the Bisq DAO.</span> <span
                md-src-pos="12192..12300">With this option he can have an arbitrator look on the problems and reimburse the traders based on the case.</span> <span md-src-pos="12301..12304">The</span> <code
                md-src-pos="12305..12321">RedirectTx Bob</code> <span md-src-pos="12322..12345">will have many outputs,</span> <span md-src-pos="12346..12399">distributing the money to all burning men of the DAO.</span>
        <span md-src-pos="12400..12413">Additionally,</span> <span md-src-pos="12414..12459">it has an anchor output with a pubkey of Bob,</span> <span
                md-src-pos="12460..12497">so he can CPFP the transaction to pay</span> <span md-src-pos="12498..12521">for higher mining fees.</span></p>
    <h3 id="claim-transaction" md-src-pos="12523..12544">claim transaction</h3>
    <p md-src-pos="12546..12899"><span md-src-pos="12546..12549">The</span> <code md-src-pos="12550..12565">ClaimTx Alice</code> <span md-src-pos="12566..12595">has an even higher time delay</span> <span class="math"
                                                                                                                                                                                                            inline="true"
                                                                                                                                                                                                            md-src-pos="12596..12601"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="28" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.804ex" height="1.756ex" role="img" focusable="false" viewBox="0 -626 797.6 776" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.339ex;">
       <defs>
        <path id="MJX-29-TEX-I-1D461"
              d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path>
        <path id="MJX-29-TEX-N-32"
              d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msub">
          <g data-mml-node="mi">
           <use data-c="1D461" xlink:href="#MJX-29-TEX-I-1D461"></use>
          </g>
          <g data-mml-node="mn" transform="translate(394,-150) scale(0.707)">
           <use data-c="32" xlink:href="#MJX-29-TEX-N-32"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mi>t</mi>
         <mn>2</mn>
        </msub>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="12602..12606">with</span> <span class="math" inline="true" md-src-pos="12607..12618"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0"
                                                                                                                                                   ctxtmenu_counter="29" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="6.626ex" height="1.756ex" role="img" focusable="false" viewBox="0 -626 2928.7 776" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.339ex;">
       <defs>
        <path id="MJX-30-TEX-I-1D461"
              d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path>
        <path id="MJX-30-TEX-N-32"
              d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path>
        <path id="MJX-30-TEX-N-3E"
              d="M84 520Q84 528 88 533T96 539L99 540Q106 540 253 471T544 334L687 265Q694 260 694 250T687 235Q685 233 395 96L107 -40H101Q83 -38 83 -20Q83 -19 83 -17Q82 -10 98 -1Q117 9 248 71Q326 108 378 132L626 250L378 368Q90 504 86 509Q84 513 84 520Z"></path>
        <path id="MJX-30-TEX-N-31"
              d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msub">
          <g data-mml-node="mi">
           <use data-c="1D461" xlink:href="#MJX-30-TEX-I-1D461"></use>
          </g>
          <g data-mml-node="mn" transform="translate(394,-150) scale(0.707)">
           <use data-c="32" xlink:href="#MJX-30-TEX-N-32"></use>
          </g>
         </g>
         <g data-mml-node="mo" transform="translate(1075.3,0)">
          <use data-c="3E" xlink:href="#MJX-30-TEX-N-3E"></use>
         </g>
         <g data-mml-node="msub" transform="translate(2131.1,0)">
          <g data-mml-node="mi">
           <use data-c="1D461" xlink:href="#MJX-30-TEX-I-1D461"></use>
          </g>
          <g data-mml-node="mn" transform="translate(394,-150) scale(0.707)">
           <use data-c="31" xlink:href="#MJX-30-TEX-N-31"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mi>t</mi>
         <mn>2</mn>
        </msub><mo>&gt;</mo><msub>
         <mi>t</mi>
         <mn>1</mn>
        </msub>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span><span md-src-pos="12618..12619">.</span> <span md-src-pos="12620..12654">This will send the funds to Alice.</span> <span
            md-src-pos="12655..12700">And will only happen if Bob fails to post his</span> <code md-src-pos="12701..12717">RedirectTx Bob</code><span md-src-pos="12717..12718">,</span> <span md-src-pos="12719..12751">which means that he is inactive.</span>
        <span md-src-pos="12752..12788">So for the case of inactive traders,</span> <span md-src-pos="12789..12802">the DAO doesn</span>'<span md-src-pos="12803..12899">t need to provide arbitration and the other trader can claim both deposits and the trade amount.</span>
    </p>
    <h2 id="advantages" md-src-pos="12901..12914">Advantages</h2>
    <ul md-src-pos="12916..13690">
        <li md-src-pos="12916..13041">privacy. A lot of effort has been put into privacy for the users. The protocol is scriptless and only uses one transaction.</li>
        <li md-src-pos="13042..13253">The happy and alternative paths are scriptless. That means as opposed to current Bisq, from looking at the transaction on the blockchain you, you have only a small likelihood that
            the transaction is from Bisq.
        </li>
        <li md-src-pos="13254..13586">In the Bisq v1 system there is a time-based connection between the fiat payment and the pay-out transaction. Whereas in this protocol the transfer of ownership is done without
            transaction on the blockchain and therefore knowing the timing of the fiat payment doesn't help as much to find the corresponding bitcoin transaction.
        </li>
        <li md-src-pos="13587..13690">lower fees. The current Bisq trade needs 4 transactions, so the fees of this protocol are much lower.</li>
    </ul>
    <h2 id="disadvantages" md-src-pos="13692..13708">Disadvantages</h2>
    <ul md-src-pos="13710..14527">
        <li md-src-pos="13710..14250">
            <p md-src-pos="13712..14250">After the trade is successfully executed, Alice and Bob have their funds locked in P' and Q' respectively. They can send that at any time with any transaction they construct.
                However, the <code md-src-pos="13900..13911">WarningTx</code> can still be posted. This is unfortunate and not very comforting that someone, after the fact, can still post a valid transaction. Misuse of
                the <code md-src-pos="14059..14070">WarningTx</code> after the trade is over is not wise because if the other player detects it, then he can make a transaction to take all the money. So the offender will
                lose at least the deposit.</p></li>
        <li md-src-pos="14252..14527">
            <p md-src-pos="14254..14527">To make normal use of the transferred funds, they should appear in the wallet. However, this may not work with each wallet. And may even need some custom wallet feature for
                handling this. Effectively that could mean that only the build-in wallet may handle this protocol.</p></li>
    </ul>
    <h2 id="conclusion" md-src-pos="14529..14542">Conclusion</h2>
    <p md-src-pos="14544..14808"><span md-src-pos="14544..14614">This protocol would provide a lot of on-chain privacy for bisq trades.</span> <span md-src-pos="14615..14644">The usability would increase,</span> <span
            md-src-pos="14645..14732">since the transfer of ownership is instant and does not need a transaction to be mined.</span> <span md-src-pos="14733..14760">The fees would considerably</span> <span
            md-src-pos="14761..14770">decrease.</span> <span md-src-pos="14771..14807">This is at least for the happy path.</span></p>
</div>
</body>
</html>