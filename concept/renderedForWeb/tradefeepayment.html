<!doctype html>
<html>
<head>
    <title>IntelliJ Markdown Preview</title>
    <meta http-equiv="Content-Security-Policy" content="default-src 'none';
script-src 'self';
style-src 'unsafe-inline';
img-src file: *;
connect-src 'none';
font-src * data: *;
object-src 'none';
media-src 'none';
child-src 'none';">
    <style type="text/css">.CtxtMenu_InfoClose {
        top: .2em;
        right: .2em;
    }

    .CtxtMenu_InfoContent {
        overflow: auto;
        text-align: left;
        font-size: 80%;
        padding: .4em .6em;
        border: 1px inset;
        margin: 1em 0px;
        max-height: 20em;
        max-width: 30em;
        background-color: #EEEEEE;
        white-space: normal;
    }

    .CtxtMenu_Info.CtxtMenu_MousePost {
        outline: none;
    }

    .CtxtMenu_Info {
        position: fixed;
        left: 50%;
        width: auto;
        text-align: center;
        border: 3px outset;
        padding: 1em 2em;
        background-color: #DDDDDD;
        color: black;
        cursor: default;
        font-family: message-box;
        font-size: 120%;
        font-style: normal;
        text-indent: 0;
        text-transform: none;
        line-height: normal;
        letter-spacing: normal;
        word-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        float: none;
        z-index: 201;
        border-radius: 15px; /* Opera 10.5 and IE9 */
        -webkit-border-radius: 15px; /* Safari and Chrome */
        -moz-border-radius: 15px; /* Firefox */
        -khtml-border-radius: 15px; /* Konqueror */
        box-shadow: 0px 10px 20px #808080; /* Opera 10.5 and IE9 */
        -webkit-box-shadow: 0px 10px 20px #808080; /* Safari 3 & Chrome */
        -moz-box-shadow: 0px 10px 20px #808080; /* Forefox 3.5 */
        -khtml-box-shadow: 0px 10px 20px #808080; /* Konqueror */
        filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */
    }
    </style>
    <style type="text/css">.CtxtMenu_MenuClose {
        position: absolute;
        cursor: pointer;
        display: inline-block;
        border: 2px solid #AAA;
        border-radius: 18px;
        -webkit-border-radius: 18px; /* Safari and Chrome */
        -moz-border-radius: 18px; /* Firefox */
        -khtml-border-radius: 18px; /* Konqueror */
        font-family: "Courier New", Courier;
        font-size: 24px;
        color: #F0F0F0
    }

    .CtxtMenu_MenuClose span {
        display: block;
        background-color: #AAA;
        border: 1.5px solid;
        border-radius: 18px;
        -webkit-border-radius: 18px; /* Safari and Chrome */
        -moz-border-radius: 18px; /* Firefox */
        -khtml-border-radius: 18px; /* Konqueror */
        line-height: 0;
        padding: 8px 0 6px /* may need to be browser-specific */
    }

    .CtxtMenu_MenuClose:hover {
        color: white !important;
        border: 2px solid #CCC !important
    }

    .CtxtMenu_MenuClose:hover span {
        background-color: #CCC !important
    }

    .CtxtMenu_MenuClose:hover:focus {
        outline: none
    }
    </style>
    <style type="text/css">.CtxtMenu_Menu {
        position: absolute;
        background-color: white;
        color: black;
        width: auto;
        padding: 5px 0px;
        border: 1px solid #CCCCCC;
        margin: 0;
        cursor: default;
        font: menu;
        text-align: left;
        text-indent: 0;
        text-transform: none;
        line-height: normal;
        letter-spacing: normal;
        word-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        float: none;
        z-index: 201;
        border-radius: 5px; /* Opera 10.5 and IE9 */
        -webkit-border-radius: 5px; /* Safari and Chrome */
        -moz-border-radius: 5px; /* Firefox */
        -khtml-border-radius: 5px; /* Konqueror */
        box-shadow: 0px 10px 20px #808080; /* Opera 10.5 and IE9 */
        -webkit-box-shadow: 0px 10px 20px #808080; /* Safari 3 & Chrome */
        -moz-box-shadow: 0px 10px 20px #808080; /* Forefox 3.5 */
        -khtml-box-shadow: 0px 10px 20px #808080; /* Konqueror */
    }

    .CtxtMenu_MenuItem {
        padding: 1px 2em;
        background: transparent;
    }

    .CtxtMenu_MenuArrow {
        position: absolute;
        right: .5em;
        padding-top: .25em;
        color: #666666;
        font-family: null;
        font-size: .75em
    }

    .CtxtMenu_MenuActive .CtxtMenu_MenuArrow {
        color: white
    }

    .CtxtMenu_MenuArrow.CtxtMenu_RTL {
        left: .5em;
        right: auto
    }

    .CtxtMenu_MenuCheck {
        position: absolute;
        left: .7em;
        font-family: null
    }

    .CtxtMenu_MenuCheck.CtxtMenu_RTL {
        right: .7em;
        left: auto
    }

    .CtxtMenu_MenuRadioCheck {
        position: absolute;
        left: .7em;
    }

    .CtxtMenu_MenuRadioCheck.CtxtMenu_RTL {
        right: .7em;
        left: auto
    }

    .CtxtMenu_MenuInputBox {
        padding-left: 1em;
        right: .5em;
        color: #666666;
        font-family: null;
    }

    .CtxtMenu_MenuInputBox.CtxtMenu_RTL {
        left: .1em;
    }

    .CtxtMenu_MenuComboBox {
        left: .1em;
        padding-bottom: .5em;
    }

    .CtxtMenu_MenuSlider {
        left: .1em;
    }

    .CtxtMenu_SliderValue {
        position: absolute;
        right: .1em;
        padding-top: .25em;
        color: #333333;
        font-size: .75em
    }

    .CtxtMenu_SliderBar {
        outline: none;
        background: #d3d3d3
    }

    .CtxtMenu_MenuLabel {
        padding: 1px 2em 3px 1.33em;
        font-style: italic
    }

    .CtxtMenu_MenuRule {
        border-top: 1px solid #DDDDDD;
        margin: 4px 3px;
    }

    .CtxtMenu_MenuDisabled {
        color: GrayText
    }

    .CtxtMenu_MenuActive {
        background-color: #606872;
        color: white;
    }

    .CtxtMenu_MenuDisabled:focus {
        background-color: #E8E8E8
    }

    .CtxtMenu_MenuLabel:focus {
        background-color: #E8E8E8
    }

    .CtxtMenu_ContextMenu:focus {
        outline: none
    }

    .CtxtMenu_ContextMenu .CtxtMenu_MenuItem:focus {
        outline: none
    }

    .CtxtMenu_SelectionMenu {
        position: relative;
        float: left;
        border-bottom: none;
        -webkit-box-shadow: none;
        -webkit-border-radius: 0px;
    }

    .CtxtMenu_SelectionItem {
        padding-right: 1em;
    }

    .CtxtMenu_Selection {
        right: 40%;
        width: 50%;
    }

    .CtxtMenu_SelectionBox {
        padding: 0em;
        max-height: 20em;
        max-width: none;
        background-color: #FFFFFF;
    }

    .CtxtMenu_SelectionDivider {
        clear: both;
        border-top: 2px solid #000000;
    }

    .CtxtMenu_Menu .CtxtMenu_MenuClose {
        top: -10px;
        left: -10px
    }
    </style>
    <style id="MJX-SVG-styles">
        mjx-container[jax="SVG"] {
            direction: ltr;
        }

        mjx-container[jax="SVG"] > svg {
            overflow: visible;
            min-height: 1px;
            min-width: 1px;
        }

        mjx-container[jax="SVG"] > svg a {
            fill: blue;
            stroke: blue;
        }

        mjx-assistive-mml {
            position: absolute !important;
            top: 0px;
            left: 0px;
            clip: rect(1px, 1px, 1px, 1px);
            padding: 1px 0px 0px 0px !important;
            border: 0px !important;
            display: block !important;
            width: auto !important;
            overflow: hidden !important;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        mjx-assistive-mml[display="block"] {
            width: 100% !important;
        }

        mjx-container[jax="SVG"][display="true"] {
            display: block;
            text-align: center;
            margin: 1em 0;
        }

        mjx-container[jax="SVG"][display="true"][width="full"] {
            display: flex;
        }

        mjx-container[jax="SVG"][justify="left"] {
            text-align: left;
        }

        mjx-container[jax="SVG"][justify="right"] {
            text-align: right;
        }

        g[data-mml-node="merror"] > g {
            fill: red;
            stroke: red;
        }

        g[data-mml-node="merror"] > rect[data-background] {
            fill: yellow;
            stroke: none;
        }

        g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
            stroke-width: 70px;
            fill: none;
        }

        g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
            stroke-width: 70px;
            fill: none;
        }

        g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
            stroke-dasharray: 140;
        }

        g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
            stroke-linecap: round;
            stroke-dasharray: 0, 140;
        }

        g[data-mml-node="mtable"] > g > svg {
            overflow: visible;
        }

        [jax="SVG"] mjx-tool {
            display: inline-block;
            position: relative;
            width: 0;
            height: 0;
        }

        [jax="SVG"] mjx-tool > mjx-tip {
            position: absolute;
            top: 0;
            left: 0;
        }

        mjx-tool > mjx-tip {
            display: inline-block;
            padding: .2em;
            border: 1px solid #888;
            font-size: 70%;
            background-color: #F8F8F8;
            color: black;
            box-shadow: 2px 2px 5px #AAAAAA;
        }

        g[data-mml-node="maction"][data-toggle] {
            cursor: pointer;
        }

        mjx-status {
            display: block;
            position: fixed;
            left: 1em;
            bottom: 1em;
            min-width: 25%;
            padding: .2em .4em;
            border: 1px solid #888;
            font-size: 90%;
            background-color: #F8F8F8;
            color: black;
        }

        foreignObject[data-mjx-xml] {
            font-family: initial;
            line-height: normal;
            overflow: visible;
        }

        mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
            stroke-width: 3;
        }
    </style>
    <style>/* Reworked by IntelliJ Team The MIT License (MIT) Copyright (c) JetBrains Adapted from https://github.com/sindresorhus/github-markdown-css The MIT License (MIT) Copyright (c) Sindre Sorhus &lt;sindresorhus@gmail.com&gt; (sindresorhus.com) Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE. */
    @font-face {
        font-family: octicons-anchor;
        src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAYcAA0AAAAACjQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAABMAAAABwAAAAca8vGTk9TLzIAAAFMAAAARAAAAFZG1VHVY21hcAAAAZAAAAA+AAABQgAP9AdjdnQgAAAB0AAAAAQAAAAEACICiGdhc3AAAAHUAAAACAAAAAj//wADZ2x5ZgAAAdwAAADRAAABEKyikaNoZWFkAAACsAAAAC0AAAA2AtXoA2hoZWEAAALgAAAAHAAAACQHngNFaG10eAAAAvwAAAAQAAAAEAwAACJsb2NhAAADDAAAAAoAAAAKALIAVG1heHAAAAMYAAAAHwAAACABEAB2bmFtZQAAAzgAAALBAAAFu3I9x/Nwb3N0AAAF/AAAAB0AAAAvaoFvbwAAAAEAAAAAzBdyYwAAAADP2IQvAAAAAM/bz7t4nGNgZGFgnMDAysDB1Ml0hoGBoR9CM75mMGLkYGBgYmBlZsAKAtJcUxgcPsR8iGF2+O/AEMPsznAYKMwIkgMA5REMOXicY2BgYGaAYBkGRgYQsAHyGMF8FgYFIM0ChED+h5j//yEk/3KoSgZGNgYYk4GRCUgwMaACRoZhDwCs7QgGAAAAIgKIAAAAAf//AAJ4nHWMMQrCQBBF/0zWrCCIKUQsTDCL2EXMohYGSSmorScInsRGL2DOYJe0Ntp7BK+gJ1BxF1stZvjz/v8DRghQzEc4kIgKwiAppcA9LtzKLSkdNhKFY3HF4lK69ExKslx7Xa+vPRVS43G98vG1DnkDMIBUgFN0MDXflU8tbaZOUkXUH0+U27RoRpOIyCKjbMCVejwypzJJG4jIwb43rfl6wbwanocrJm9XFYfskuVC5K/TPyczNU7b84CXcbxks1Un6H6tLH9vf2LRnn8Ax7A5WQAAAHicY2BkYGAA4teL1+yI57f5ysDNwgAC529f0kOmWRiYVgEpDgYmEA8AUzEKsQAAAHicY2BkYGB2+O/AEMPCAAJAkpEBFbAAADgKAe0EAAAiAAAAAAQAAAAEAAAAAAAAKgAqACoAiAAAeJxjYGRgYGBhsGFgYgABEMkFhAwM/xn0QAIAD6YBhwB4nI1Ty07cMBS9QwKlQapQW3VXySvEqDCZGbGaHULiIQ1FKgjWMxknMfLEke2A+IJu+wntrt/QbVf9gG75jK577Lg8K1qQPCfnnnt8fX1NRC/pmjrk/zprC+8D7tBy9DHgBXoWfQ44Av8t4Bj4Z8CLtBL9CniJluPXASf0Lm4CXqFX8Q84dOLnMB17N4c7tBo1AS/Qi+hTwBH4rwHHwN8DXqQ30XXAS7QaLwSc0Gn8NuAVWou/gFmnjLrEaEh9GmDdDGgL3B4JsrRPDU2hTOiMSuJUIdKQQayiAth69r6akSSFqIJuA19TrzCIaY8sIoxyrNIrL//pw7A2iMygkX5vDj+G+kuoLdX4GlGK/8Lnlz6/h9MpmoO9rafrz7ILXEHHaAx95s9lsI7AHNMBWEZHULnfAXwG9/ZqdzLI08iuwRloXE8kfhXYAvE23+23DU3t626rbs8/8adv+9DWknsHp3E17oCf+Z48rvEQNZ78paYM38qfk3v/u3l3u3GXN2Dmvmvpf1Srwk3pB/VSsp512bA/GG5i2WJ7wu430yQ5K3nFGiOqgtmSB5pJVSizwaacmUZzZhXLlZTq8qGGFY2YcSkqbth6aW1tRmlaCFs2016m5qn36SbJrqosG4uMV4aP2PHBmB3tjtmgN2izkGQyLWprekbIntJFing32a5rKWCN/SdSoga45EJykyQ7asZvHQ8PTm6cslIpwyeyjbVltNikc2HTR7YKh9LBl9DADC0U/jLcBZDKrMhUBfQBvXRzLtFtjU9eNHKin0x5InTqb8lNpfKv1s1xHzTXRqgKzek/mb7nB8RZTCDhGEX3kK/8Q75AmUM/eLkfA+0Hi908Kx4eNsMgudg5GLdRD7a84npi+YxNr5i5KIbW5izXas7cHXIMAau1OueZhfj+cOcP3P8MNIWLyYOBuxL6DRylJ4cAAAB4nGNgYoAALjDJyIAOWMCiTIxMLDmZedkABtIBygAAAA==) format('woff');
    }

    body {
        -webkit-text-size-adjust: 100%;
        -ms-text-size-adjust: 100%;
        font-family: Helvetica, Arial, freesans, sans-serif;
        font-size: 14px;
        line-height: 1.6;
        word-wrap: break-word;
        margin: 0 2em;
    }

    strong {
        font-weight: bold;
    }

    img {
        border: 0;
    }

    input {
        color: inherit;
        font: inherit;
        margin: 0;
        line-height: normal;
    }

    html input[disabled] {
        cursor: default;
    }

    input[type="checkbox"] {
        box-sizing: border-box;
        padding: 0;
    }

    body * {
        box-sizing: border-box;
    }

    input {
        font: 13px/1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
    }

    a {
        text-decoration: none;
    }

    a:hover, a:active {
        text-decoration: underline;
    }

    hr {
        height: 1px;
        padding: 0;
        margin: 20px 0;
        border: 0 none;
    }

    hr:before {
        display: table;
        content: "";
    }

    hr:after {
        display: table;
        clear: both;
        content: "";
    }

    blockquote {
        margin: 0;
    }

    ul, ol {
        padding: 0;
        margin-top: 0;
        margin-bottom: 0;
    }

    ol ol, ul ol {
        list-style-type: lower-roman;
    }

    ul ul ol, ul ol ol, ol ul ol, ol ol ol {
        list-style-type: lower-alpha;
    }

    dd {
        margin-left: 0;
    }

    .octicon {
        font: normal normal normal 16px/1 octicons-anchor;
        display: inline-block;
        text-decoration: none;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }

    .octicon-link:before {
        content: '\f05c';
    }

    .markdown-body & gt

    ;
    *:first-child {
        margin-top: 0 !important;
    }

    .markdown-body & gt

    ;
    *:last-child {
        margin-bottom: 0 !important;
    }

    .anchor {
        position: absolute;
        top: 0;
        left: 0;
        display: block;
        padding-right: 6px;
        padding-left: 30px;
        margin-left: -30px;
    }

    .anchor:focus {
        outline: none;
    }

    h1, h2, h3, h4, h5, h6 {
        position: relative;
        margin-top: 1em;
        margin-bottom: 16px;
        font-weight: bold;
        line-height: 1.4;
    }

    h1 .octicon-link, h2 .octicon-link, h3 .octicon-link, h4 .octicon-link, h5 .octicon-link, h6 .octicon-link {
        display: none;
        color: #000;
        vertical-align: middle;
    }

    h1:hover .anchor, h2:hover .anchor, h3:hover .anchor, h4:hover .anchor, h5:hover .anchor, h6:hover .anchor {
        padding-left: 8px;
        margin-left: -30px;
        text-decoration: none;
    }

    h1:hover .anchor .octicon-link, h2:hover .anchor .octicon-link, h3:hover .anchor .octicon-link, h4:hover .anchor .octicon-link, h5:hover .anchor .octicon-link, h6:hover .anchor .octicon-link {
        display: inline-block;
    }

    h1 {
        font-size: 2.2em;
        padding-top: 0.6em;
    }

    h1 .anchor {
        line-height: 1;
    }

    h2 {
        font-size: 1.8em;
        line-height: 1.2;
        padding-top: 0.6em;
    }

    h2 .anchor {
        line-height: 1.2;
    }

    h3 {
        font-size: 1.3em;
        line-height: 1;
        padding-top: 0.6em;
    }

    h3 .anchor {
        line-height: 1.2;
    }

    h4 {
        font-size: 1em;
    }

    h4 .anchor {
        line-height: 1.2;
    }

    h5 {
        font-size: 1em;
    }

    h5 .anchor {
        line-height: 1.1;
    }

    h6 {
        font-size: 1em;
    }

    h6 .anchor {
        line-height: 1.1;
    }

    p, blockquote, ul, ol, dl, table, pre {
        margin-top: 16px;
        margin-bottom: 16px;
    }

    pre.frontmatter-header {
        background-color: transparent;
        margin: 0;
        padding: 0;
    }

    ul, ol {
        padding-left: 2em;
    }

    ul ul, ul ol, ol ol, ol ul {
        margin-top: 0;
        margin-bottom: 0;
    }

    li & gt

    ;
    p {
        margin-top: 0;
        margin-bottom: 0;
    }

    dl {
        padding: 0;
    }

    dl dt {
        padding: 0;
        margin-top: 16px;
        font-size: 1em;
        font-style: italic;
        font-weight: bold;
    }

    dl dd {
        padding: 0 16px;
        margin-bottom: 16px;
    }

    blockquote {
        padding: 10px 10px 10px 16px;
        border-left: 2px solid;
        border-radius: 0 3px 3px 0;
    }

    blockquote & gt

    ;
    :first-child {
        margin-top: 0;
    }

    blockquote & gt

    ;
    :last-child {
        margin-bottom: 0;
    }

    table {
        display: block;
        width: 100%;
        overflow: auto;
        word-break: normal;
        border-collapse: collapse;
        border-spacing: 0;
        font-size: 1em;
    }

    table th {
        font-weight: bold;
    }

    table th, table td {
        padding: 6px 13px;
        background: transparent;
    }

    table tr {
        border-top: 1px solid;
    }

    img {
        max-width: 100%;
        box-sizing: border-box;
    }

    code {
        font: 0.9em "JetBrains Mono", Consolas, "Liberation Mono", Menlo, Courier, monospace;
        padding: 0.2em 0.4em;
        margin: 2px;
        border-radius: 3px;
    }

    pre & gt

    ;
    code {
        padding: 0;
        margin: 0;
        font-size: 100%;
        word-break: normal;
        white-space: pre;
        background: transparent;
        border: 0;
    }

    .highlight {
        margin-bottom: 16px;
    }

    .highlight pre, pre {
        font: 0.85em "JetBrains Mono", Consolas, "Liberation Mono", Menlo, Courier, monospace;
        padding: 16px;
        overflow: auto;
        line-height: 1.45;
        border-radius: 3px;
    }

    pre code {
        display: inline;
        max-width: initial;
        padding: 0;
        margin: 0;
        overflow: initial;
        line-height: inherit;
        word-wrap: normal;
        background-color: transparent;
        border: 0;
    }

    pre code:before, pre code:after {
        content: normal;
    }

    kbd {
        font: 0.9em "JetBrains Mono", Consolas, "Liberation Mono", Menlo, Courier, monospace;
        padding: 0.2em 0.4em;
        margin: 2px;
        border-radius: 3px;
    }

    .task-list-item {
        list-style-type: none;
    }

    .task-list-item + .task-list-item {
        margin-top: 3px;
    }

    .task-list-item input {
        margin: 0 0.35em 0.25em -0.6em;
        vertical-align: middle;
    }

    :checked + .radio-label {
        z-index: 1;
        position: relative;
    }

    span.user-del {
        text-decoration: line-through;
    }

    ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
    }

    ::-webkit-scrollbar-thumb {
        -webkit-border-radius: 10px;
    }

    ::-webkit-scrollbar-track:vertical {
        -webkit-box-shadow: -1px 0 0 #ededed;
    }

    ::-webkit-scrollbar-track {
        background-color: transparent;
    }

    ::-webkit-scrollbar {
        width: 6px;
    }</style>
    <style>:root {
        --default-font-size: 22px;
        --scale: 1.0;
    }

    body {
        background-color: rgba(30, 31, 34, 255.0);
        font-size: var(--default-font-size) !important;
        transform: scale(var(--scale)) !important;
        transform-origin: 0 0;
    }

    body, p, blockquote, ul, ol, dl, table, pre, code, tr {
        color: rgba(188, 190, 196, 255.0);
    }

    a {
        color: rgba(107, 155, 250, 255.0);
    }

    table td, table th {
        border: 1px solid rgba(57, 59, 64, 255.0);
    }

    hr {
        background-color: rgba(57, 59, 64, 255.0);
    }

    kbd, tr {
        border: 1px solid rgba(57, 59, 64, 255.0);
    }

    h6 {
        color: rgba(111, 115, 122, 255.0);
    }

    blockquote {
        border-left: 2px solid rgba(107, 155, 250, 0.4);
    }

    blockquote, code, pre {
        background-color: rgba(212, 222, 231, 0.09803921568627451);
    }

    ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
        background-color: rgba(0, 0, 0, 0);
    }

    ::-webkit-scrollbar-track {
        background-color: rgba(0, 0, 0, 0);
    }

    ::-webkit-scrollbar-track:hover {
        background-color: rgba(0, 0, 0, 0);
    }

    ::-webkit-scrollbar-thumb {
        background-color: rgba(166, 166, 166, 0.278431);
        border-radius: 0px;
        border-width: 1px;
        border-style: solid;
        border-color: rgba(0, 0, 0, 0);
        background-clip: padding-box;
        outline: 1px solid rgba(56, 56, 56, 0.278431);
        outline-offset: -1px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background-color: rgba(166, 166, 166, 0.349020);
        border-radius: 0px;
        border-width: 1px;
        border-style: solid;
        border-color: rgba(0, 0, 0, 0);
        background-clip: padding-box;
        outline: 1px solid rgba(56, 56, 56, 0.349020);
        outline-offset: -1px;
    }

    ::-webkit-scrollbar-corner {
        background-color: rgba(0, 0, 0, 0);
    }

    ::-webkit-scrollbar-button {
        display: none;
    }</style>
    <style>/* Copyright 2000-2021 JetBrains s.r.o. and contributors. Use of this source code is governed by the Apache 2.0 license that can be found in the LICENSE file. */
    .code-fence-highlighter-copy-button {
        display: flex;
        position: absolute;
        float: left;
        margin-left: -1em;
        margin-top: -1em;
    }

    .code-fence-highlighter-copy-button-icon {
        visibility: hidden;
        max-width: 1em;
    }

    .code-fence:hover .code-fence-highlighter-copy-button-icon {
        visibility: visible; /*noinspection CssUnknownTarget*/
        content: url("copy-button-copy-icon.png");
    }

    .code-fence:hover .code-fence-highlighter-copy-button:hover .code-fence-highlighter-copy-button-icon { /*noinspection CssUnknownTarget*/
        content: url("copy-button-copy-icon-hovered.png");
        cursor: pointer;
    }

    .code-fence-highlighter-copy-button .tooltiptext {
        visibility: hidden;
        width: 120px;
        background-color: rgba(85, 85, 85, 0.4);
        color: #fff;
        text-align: center;
        border-radius: 6px;
        padding: 2px 0;
        position: absolute;
        font-size: 10px;
        z-index: 1;
        top: -4px;
        left: 120%;
        opacity: 0;
        transition: opacity 0.3s;
    }

    .code-fence-highlighter-copy-button:hover .tooltiptext {
        visibility: visible;
        opacity: 1;
    }</style>
    <style>/* Copyright 2000-2021 JetBrains s.r.o. and contributors. Use of this source code is governed by the Apache 2.0 license that can be found in the LICENSE file. */
    .run-icon & gt

    ;
    img {
        max-width: 1em;
        vertical-align: text-top;
        margin-right: 0.3em;
    }

    .code-block {
        position: absolute;
        left: 1em;
    }

    .hidden {
        display: none;
    }</style>
</head>
<body>
<div md-src-pos="0..7309">
    <h1 id="trade-fee-payment-on-chain" md-src-pos="0..28">trade fee payment on chain</h1>
    <p md-src-pos="30..334"><span md-src-pos="30..102">This outlines a concept for trade fee payment using on-chain techniques.</span> <span md-src-pos="103..134">The Solution presented includes</span> '<span
            md-src-pos="136..167">unidirectional payment channels</span>' <span md-src-pos="169..184">as described in</span> <span md-src-pos="185..193">the book</span> '<span
            md-src-pos="195..212">Mastering Bitcoin</span>' <span md-src-pos="214..233">and silent payments</span> (<span md-src-pos="235..242">BIP-352</span>)<span md-src-pos="243..244">.</span> <span
            md-src-pos="245..272">To understand this article,</span> <span md-src-pos="273..320">you probably need an understanding of these two</span> <span md-src-pos="321..334">technologies.</span></p>
    <h2 id="requirements" md-src-pos="336..351">requirements</h2>
    <ul md-src-pos="353..823">
        <li md-src-pos="353..375">one channel per user</li>
        <li md-src-pos="376..444">channel directly to contributor (otherwise too many on-chain fees)</li>
        <li md-src-pos="445..484">creating a channel is no requirement.</li>
        <li md-src-pos="485..543">channel capacity is limited to DPT-like-amounts or less.</li>
        <li md-src-pos="544..578">one channel with one contributor</li>
        <li md-src-pos="579..637">contributor must not be online when creating the channel</li>
        <li md-src-pos="638..694">contributor must not be online when a channel is used.</li>
        <li md-src-pos="695..769">trader should be able to close the channel (even if BM is unresponsive).</li>
        <li md-src-pos="770..823">no address reuse on the trader or contributor side.</li>
    </ul>
    <h2 id="unidrectional-channels" md-src-pos="825..850">unidrectional channels</h2>
    <p md-src-pos="852..924"><img src="http://localhost:63342/markdownPreview/1719687670/concept/renderedForWeb/tradefeepayment.drawio.png?_ijt=8k86gj0cjl1r5u47n1dplug6df" alt="tradefeepaymentdrawiopng"
                                  __idea-generated="true" md-src-pos="852..924" data-original-src="concept/renderedForWeb/tradefeepayment.drawio.png"></p>
    <h3 id="opening" md-src-pos="926..937">opening</h3>
    <p md-src-pos="939..1514"><span md-src-pos="939..984">Trader broadcast a transaction to a multisig,</span> <span md-src-pos="985..1012">between the trader and a BM</span> (<span
            md-src-pos="1014..1023">ChannelTx</span>)<span md-src-pos="1024..1025">.</span> <span md-src-pos="1026..1047">If the trade shall be</span> <span md-src-pos="1048..1111">able to initiate the channel without communicating with the BM,</span>
        <span md-src-pos="1112..1142">the trader will not be able to</span> <span md-src-pos="1143..1172">do the multisig using MuSig2.</span> <span md-src-pos="1173..1181">Instead,</span> <span md-src-pos="1182..1219">he will need to use a taproot-script.</span>
        <span md-src-pos="1220..1237">For the script he</span> <span md-src-pos="1238..1275">needs to have a public key of the BM.</span> <span
                md-src-pos="1276..1322">This could be provided using a silent payment,</span> <span md-src-pos="1323..1326">see</span> <a href="https://github.com/bitcoin/bips/blob/master/bip-0352.mediawiki"
                                                                                                                                          md-src-pos="1327..1400">BIP-352</a><span md-src-pos="1400..1401">.</span> <span
                md-src-pos="1402..1427">When opening the channel,</span> <span md-src-pos="1428..1484">the trade has to decide which capacity the channel gets.</span> <span md-src-pos="1485..1501">The channel size</span>
        <span md-src-pos="1502..1514">has a limit.</span></p>
    <h3 id="usage" md-src-pos="1516..1525">usage</h3>
    <p md-src-pos="1527..1995"><span md-src-pos="1527..1560">With each trade this trader does,</span> <span md-src-pos="1561..1612">he can use the trade channel to pay the trade fees.</span> <span
            md-src-pos="1613..1622">To do so,</span> <span md-src-pos="1623..1701">he will create a transaction from the channel multisig to an address of the BM</span> (<span md-src-pos="1703..1714">get address</span>
        <span md-src-pos="1715..1735">using silent payment</span>)<span md-src-pos="1736..1737">.</span> <span md-src-pos="1738..1784">Then he presigns the transaction with his key.</span> <span md-src-pos="1785..1793">Since it</span>'<span
                md-src-pos="1794..1807">s a multisig,</span> <span md-src-pos="1808..1811">his</span> <span md-src-pos="1812..1830">key is not enough,</span> <span md-src-pos="1831..1870">but the BM can complete it at any time.</span>
        <span md-src-pos="1871..1906">For each trade fee the trader signs</span> <span md-src-pos="1907..1927">another transaction,</span> <span md-src-pos="1928..1995">the amount must be the amount of the last transaction plus the fee.</span>
    </p>
    <h3 id="verification-of-the-channel-from-the-second-trader" md-src-pos="1997..2051">verification of the channel from the second trader</h3>
    <p md-src-pos="2053..2120"><span md-src-pos="2053..2119">The first trader will send the second trader the following message</span>:</p>
    <ol md-src-pos="2122..2428">
        <li md-src-pos="2122..2146">channel opening TxId.</li>
        <li md-src-pos="2147..2210">channel update transaction (this is the payment of the fees)</li>
        <li md-src-pos="2211..2244">channel RedirectTx (see below)</li>
        <li md-src-pos="2245..2336">random value generated by the second trader (the second trader needs to send this first)</li>
        <li md-src-pos="2337..2428">Signature of 1,2 and 3 to be verified with the pubkey key used in 1. (Schnorr Signature)</li>
    </ol>
    <p md-src-pos="2430..2472"><span md-src-pos="2430..2471">The second trader verifies the message by</span>:</p>
    <ol md-src-pos="2474..2923">
        <li md-src-pos="2474..2608">channel opening transaction exists on blockchain, and the second party in the channel is the BM (see below the proof of payment)</li>
        <li md-src-pos="2609..2721">verify channel update transaction
            <ol md-src-pos="2649..2721">
                <li md-src-pos="2649..2692">is signed correctly by the first trader</li>
                <li md-src-pos="2696..2721">the amount is correct</li>
            </ol>
        </li>
        <li md-src-pos="2722..2776">channel opening transaction capacity isn't exceeded</li>
        <li md-src-pos="2777..2865">channel RedirectTx is partially signed by the first trader and sends funds to all BMs</li>
        <li md-src-pos="2866..2897">the random value is correct.</li>
        <li md-src-pos="2898..2923">Signature verification</li>
    </ol>
    <p md-src-pos="2925..3414"><span md-src-pos="2925..2953">He does not verify the rest,</span> <span md-src-pos="2954..3015">especially not against previous transaction and double spend.</span> <span
            md-src-pos="3016..3027">Although it</span>'<span md-src-pos="3028..3104">s unnecessary that the second trader verifies the channel update transaction</span>'<span
            md-src-pos="3105..3125">s beneficiary is the</span> <span md-src-pos="3126..3138">intended BM,</span> <span md-src-pos="3139..3190">because that can be made later on by the BM itself.</span> <span
            md-src-pos="3191..3201">The second</span> <span md-src-pos="3202..3263">trader encrypts that message and sends it to the bisq network</span> <span md-src-pos="3264..3288">for everyone to receive.</span> <span
            md-src-pos="3289..3314">Among everyone is the BM,</span> <span md-src-pos="3315..3328">the receiver.</span> <span md-src-pos="3329..3362">The BM does not need to be online</span> <span
            md-src-pos="3363..3414">and can verify his part at any later point in time.</span></p>
    <p md-src-pos="3416..3562"><span md-src-pos="3416..3435">After verification,</span> <span md-src-pos="3436..3520">the second trader will encrypt the message from the first trader with the BMs pubkey</span> <span
            md-src-pos="3521..3562">and send it to the message box of the BM.</span></p>
    <h3 id="verification-from-bm" md-src-pos="3564..3588">verification from BM</h3>
    <p md-src-pos="3590..4312"><span md-src-pos="3590..3619">Whenever the BM comes online,</span> <span md-src-pos="3620..3675">he will collect all messages and tries to decrypt them.</span> <span
            md-src-pos="3676..3682">He can</span> <span md-src-pos="3683..3711">decrypt all messages to him.</span> <span md-src-pos="3712..3777">From those messages he learns which channel-opening Txids are for</span>
        <span md-src-pos="3778..3782">him.</span> <span md-src-pos="3783..3876">He verifies all messages with the same Txid and checks if the channel update transactions are</span> <span md-src-pos="3877..3917">correct and the amounts add up properly.</span>
        <span md-src-pos="3918..3925">If not,</span> <span md-src-pos="3926..3965">he signs and broadcasts the RedirectTx,</span> <span md-src-pos="3966..3971">which</span> <span md-src-pos="3972..4019">will send all funds to the DAO for arbitration.</span>
        <span md-src-pos="4020..4067">The second trader has posted the channel update</span> <span md-src-pos="4068..4100">transactions which he validated.</span> <span md-src-pos="4101..4115">So if they don</span>'<span
                md-src-pos="4116..4125">t add up,</span> <span md-src-pos="4126..4161">or there are too many transactions,</span> <span md-src-pos="4162..4165">the</span> <span md-src-pos="4166..4218">arbitrator can decide if there was a fraud going on.</span>
        <span md-src-pos="4219..4312">Note that the bisq-software can make the decision of the BM and the arbitrator automatically.</span></p>
    <h3 id="close-of-the-channel-by-bm" md-src-pos="4314..4344">close of the channel by BM</h3>
    <p md-src-pos="4346..4601"><span md-src-pos="4346..4413">In the happy path the BM will close the channel when the time is up</span> (<span md-src-pos="4415..4430">anywhere before</span> <span class="math"
                                                                                                                                                                                                    inline="true"
                                                                                                                                                                                                    md-src-pos="4431..4436"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9020" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.804ex" height="1.756ex" role="img" focusable="false" viewBox="0 -626 797.6 776" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.339ex;">
       <defs>
        <path id="MJX-9021-TEX-I-1D461"
              d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path>
        <path id="MJX-9021-TEX-N-31"
              d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="msub">
          <g data-mml-node="mi">
           <use data-c="1D461" xlink:href="#MJX-9021-TEX-I-1D461"></use>
          </g>
          <g data-mml-node="mn" transform="translate(394,-150) scale(0.707)">
           <use data-c="31" xlink:href="#MJX-9021-TEX-N-31"></use>
          </g>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <msub>
         <mi>t</mi>
         <mn>1</mn>
        </msub>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="4437..4444">expires</span>)<span md-src-pos="4445..4446">,</span> <span md-src-pos="4447..4501">or the BM is asked to close the channel by the trader.</span> <span
            md-src-pos="4502..4521">After verification,</span> <span md-src-pos="4522..4601">he will issue the latest channel state transaction and that ends this protocol.</span></p>
    <h3 id="close-of-the-channel-by-trader" md-src-pos="4603..4637">close of the channel by trader</h3>
    <p md-src-pos="4639..5021"><span md-src-pos="4639..4690">The trader cannot close the channel without the BM.</span> <span md-src-pos="4691..4727">Once a BM gets to know a new channel</span> <span
            md-src-pos="4728..4739">has opened,</span> <span md-src-pos="4740..4772">the BM sends a signature for the</span> <code md-src-pos="4773..4785">RedirectTx</code> <span
            md-src-pos="4786..4800">to the trader.</span> <span md-src-pos="4801..4862">With it the trader can send the funds at any time to the DAO,</span> <span md-src-pos="4863..4878">which will need</span> <span
            md-src-pos="4879..4911">to resolve the fund with the BM.</span> <span md-src-pos="4912..4920">However,</span> <span md-src-pos="4921..4949">if the BM is not responsive,</span> <span md-src-pos="4950..4988">the trader can only use up the channel</span>
        <span md-src-pos="4989..5021">capacity for further trade fees.</span></p>
    <h3 id="proof-of-silent-payment" md-src-pos="5023..5050">proof of silent payment</h3>
    <p md-src-pos="5052..5179"><span md-src-pos="5052..5136">The second trader needs to make sure that the channel-opening transaction is correct</span> <span md-src-pos="5137..5166">and is actually on the chain.</span>
        <span md-src-pos="5167..5178">He verifies</span>:</p>
    <ul md-src-pos="5181..5484">
        <li md-src-pos="5181..5225">transaction is confirmed on the blockchain</li>
        <li md-src-pos="5226..5282">amount is high enough for at least the current payment</li>
        <li md-src-pos="5283..5484">transaction beneficiary is multisig with the BM with silent payment address Pubkey <span class="math" inline="true" md-src-pos="5368..5371"><mjx-container
                class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9021" style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="1.459ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 645 727" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: -0.05ex;">
        <defs>
         <path id="MJX-9022-TEX-I-1D446"
               d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="mi">
           <use data-c="1D446" xlink:href="#MJX-9022-TEX-I-1D446"></use>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <mi>S</mi>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span>. He does not get the address <span class="math" inline="true" md-src-pos="5403..5406"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9022"
                                                                                                                                   style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="1.459ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 645 727" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: -0.05ex;">
        <defs>
         <path id="MJX-9023-TEX-I-1D446"
               d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="mi">
           <use data-c="1D446" xlink:href="#MJX-9023-TEX-I-1D446"></use>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <mi>S</mi>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span> from the other trader, instead that payment address must come from the DAO.
        </li>
    </ul>
    <p md-src-pos="5486..5948"><span md-src-pos="5486..5539">The first trader needs to proof to the second trader,</span> <span md-src-pos="5540..5564">that the used Public key</span> <span class="math" inline="true"
                                                                                                                                                                                              md-src-pos="5565..5568"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9023" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.717ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 759 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: 0px;">
       <defs>
        <path id="MJX-9024-TEX-I-1D435"
              d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mi">
          <use data-c="1D435" xlink:href="#MJX-9024-TEX-I-1D435"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>B</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="5569..5571">is</span> <span md-src-pos="5572..5615">actually a silent payment address of the BM</span> (<span md-src-pos="5617..5629">derived from</span> <span class="math"
                                                                                                                                                                                                               inline="true"
                                                                                                                                                                                                               md-src-pos="5630..5633"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9024" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.459ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 645 727" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.05ex;">
       <defs>
        <path id="MJX-9025-TEX-I-1D446"
              d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mi">
          <use data-c="1D446" xlink:href="#MJX-9025-TEX-I-1D446"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>S</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span>)<span md-src-pos="5634..5635">.</span> <span md-src-pos="5636..5686">The BM needs to publish his silent payment address</span> <span class="math" inline="true" md-src-pos="5687..5690"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9025" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.459ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 645 727" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.05ex;">
       <defs>
        <path id="MJX-9026-TEX-I-1D446"
              d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mi">
          <use data-c="1D446" xlink:href="#MJX-9026-TEX-I-1D446"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>S</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="5691..5705">to the public.</span> <span md-src-pos="5706..5718">According to</span> <a href="https://github.com/bitcoin/bips/blob/master/bip-0352.mediawiki"
                                                                                                                                      md-src-pos="5719..5792">BIP-352</a><span md-src-pos="5792..5793">,</span> <span
            md-src-pos="5794..5802">see also</span> <a href="file:/mnt/work/extra/dev/bisq-musig/concept/SilentPayment.md" md-src-pos="5803..5837">this explainer</a><span md-src-pos="5837..5838">,</span> <span
            md-src-pos="5839..5850">the address</span> <span md-src-pos="5851..5889">for a silent payment is calculated via</span>: <span class="math" inline="false" md-src-pos="5891..5942"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" display="true" tabindex="0" ctxtmenu_counter="9026" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="27.31ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 12070.9 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.566ex;">
       <defs>
        <path id="MJX-9027-TEX-N-28"
              d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path>
        <path id="MJX-9027-TEX-N-31"
              d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path>
        <path id="MJX-9027-TEX-N-29"
              d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path>
        <path id="MJX-9027-TEX-I-1D435"
              d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path>
        <path id="MJX-9027-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path>
        <path id="MJX-9027-TEX-I-1D446"
              d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path>
        <path id="MJX-9027-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path>
        <path id="MJX-9027-TEX-I-210E"
              d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path>
        <path id="MJX-9027-TEX-I-1D44E"
              d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
        <path id="MJX-9027-TEX-I-1D460"
              d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path>
        <path id="MJX-9027-TEX-N-22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z"></path>
        <path id="MJX-9027-TEX-I-1D43A"
              d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q492 659 471 656T418 643T357 615T294 567T236 496T189 394T158 260Q156 242 156 221Q156 173 170 136T206 79T256 45T308 28T353 24Q407 24 452 47T514 106Q517 114 529 161T541 214Q541 222 528 224T468 227H431Q425 233 425 235T427 254Q431 267 437 273H454Q494 271 594 271Q634 271 659 271T695 272T707 272Q721 272 721 263Q721 261 719 249Q714 230 709 228Q706 227 694 227Q674 227 653 224Q646 221 643 215T629 164Q620 131 614 108Q589 6 586 3Q584 1 581 1Q571 1 553 21T530 52Q530 53 528 52T522 47Q448 -22 322 -22Q201 -22 126 55T50 252Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mo">
          <use data-c="28" xlink:href="#MJX-9027-TEX-N-28"></use>
         </g>
         <g data-mml-node="mn" transform="translate(389,0)">
          <use data-c="31" xlink:href="#MJX-9027-TEX-N-31"></use>
         </g>
         <g data-mml-node="mo" transform="translate(889,0)">
          <use data-c="29" xlink:href="#MJX-9027-TEX-N-29"></use>
         </g>
         <g data-mml-node="mspace" transform="translate(1278,0)"></g>
         <g data-mml-node="mi" transform="translate(1778,0)">
          <use data-c="1D435" xlink:href="#MJX-9027-TEX-I-1D435"></use>
         </g>
         <g data-mml-node="mo" transform="translate(2814.8,0)">
          <use data-c="3D" xlink:href="#MJX-9027-TEX-N-3D"></use>
         </g>
         <g data-mml-node="mi" transform="translate(3870.6,0)">
          <use data-c="1D446" xlink:href="#MJX-9027-TEX-I-1D446"></use>
         </g>
         <g data-mml-node="mo" transform="translate(4737.8,0)">
          <use data-c="2B" xlink:href="#MJX-9027-TEX-N-2B"></use>
         </g>
         <g data-mml-node="mi" transform="translate(5738,0)">
          <use data-c="210E" xlink:href="#MJX-9027-TEX-I-210E"></use>
         </g>
         <g data-mml-node="mi" transform="translate(6314,0)">
          <use data-c="1D44E" xlink:href="#MJX-9027-TEX-I-1D44E"></use>
         </g>
         <g data-mml-node="mi" transform="translate(6843,0)">
          <use data-c="1D460" xlink:href="#MJX-9027-TEX-I-1D460"></use>
         </g>
         <g data-mml-node="mi" transform="translate(7312,0)">
          <use data-c="210E" xlink:href="#MJX-9027-TEX-I-210E"></use>
         </g>
         <g data-mml-node="mo" transform="translate(7888,0)">
          <use data-c="28" xlink:href="#MJX-9027-TEX-N-28"></use>
         </g>
         <g data-mml-node="mi" transform="translate(8277,0)">
          <use data-c="1D44E" xlink:href="#MJX-9027-TEX-I-1D44E"></use>
         </g>
         <g data-mml-node="mo" transform="translate(9028.2,0)">
          <use data-c="22C5" xlink:href="#MJX-9027-TEX-N-22C5"></use>
         </g>
         <g data-mml-node="mi" transform="translate(9528.4,0)">
          <use data-c="1D446" xlink:href="#MJX-9027-TEX-I-1D446"></use>
         </g>
         <g data-mml-node="mo" transform="translate(10173.4,0)">
          <use data-c="29" xlink:href="#MJX-9027-TEX-N-29"></use>
         </g>
         <g data-mml-node="mo" transform="translate(10784.7,0)">
          <use data-c="22C5" xlink:href="#MJX-9027-TEX-N-22C5"></use>
         </g>
         <g data-mml-node="mi" transform="translate(11284.9,0)">
          <use data-c="1D43A" xlink:href="#MJX-9027-TEX-I-1D43A"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="block">
       <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
        <mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mspace width="5pt"></mspace><mi>B</mi><mo>=</mo><mi>S</mi><mo>+</mo><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>a</mi><mo></mo><mi>S</mi><mo
               stretchy="false">)</mo><mo></mo><mi>G</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="5943..5948">where</span></p>
    <ul md-src-pos="5950..6081">
        <li md-src-pos="5950..5999"><span class="math" inline="true" md-src-pos="5952..5955"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9027" style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="1.459ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 645 727" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: -0.05ex;">
        <defs>
         <path id="MJX-9028-TEX-I-1D446"
               d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="mi">
           <use data-c="1D446" xlink:href="#MJX-9028-TEX-I-1D446"></use>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <mi>S</mi>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span> is the pubkey of the silent payment address
        </li>
        <li md-src-pos="6000..6037"><span class="math" inline="true" md-src-pos="6002..6005"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9028" style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="1.197ex" height="1.02ex" role="img" focusable="false" viewBox="0 -441 529 451" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: -0.023ex;">
        <defs>
         <path id="MJX-9029-TEX-I-1D44E"
               d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="mi">
           <use data-c="1D44E" xlink:href="#MJX-9029-TEX-I-1D44E"></use>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <mi>a</mi>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span> is a secret of the first trader
        </li>
        <li md-src-pos="6038..6081"><span class="math" inline="true" md-src-pos="6040..6043"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9029" style="position: relative;">
       <svg xmlns="http://www.w3.org/2000/svg" width="1.717ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 759 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
            style="vertical-align: 0px;">
        <defs>
         <path id="MJX-9030-TEX-I-1D435"
               d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path>
        </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
         <g data-mml-node="math">
          <g data-mml-node="mi">
           <use data-c="1D435" xlink:href="#MJX-9030-TEX-I-1D435"></use>
          </g>
         </g>
        </g>
       </svg>
       <mjx-assistive-mml unselectable="on" display="inline">
        <math xmlns="http://www.w3.org/1998/Math/MathML">
         <mi>B</mi>
        </math>
       </mjx-assistive-mml>
      </mjx-container></span> is the pubkey of the receiver address
        </li>
    </ul>
    <p md-src-pos="6083..6453"><a href="https://github.com/bitcoin/bips/blob/master/bip-0374.mediawiki" md-src-pos="6083..6156">BIP-374</a> <span md-src-pos="6157..6164">defines</span> <span md-src-pos="6165..6171">a DLEQ</span>
        (<span md-src-pos="6173..6221">zero-knowledge discrete logarithm equality proof</span>) <span md-src-pos="6223..6259">to prove that the calculated address</span> <span class="math" inline="true"
                                                                                                                                                                                md-src-pos="6260..6263"><mjx-container
                class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9030" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.717ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 759 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: 0px;">
       <defs>
        <path id="MJX-9031-TEX-I-1D435"
              d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mi">
          <use data-c="1D435" xlink:href="#MJX-9031-TEX-I-1D435"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>B</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="6264..6323">is actually the correct address derived from silent payment</span> <span class="math" inline="true" md-src-pos="6324..6327"><mjx-container
                class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9031" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.459ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 645 727" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.05ex;">
       <defs>
        <path id="MJX-9032-TEX-I-1D446"
              d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mi">
          <use data-c="1D446" xlink:href="#MJX-9032-TEX-I-1D446"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>S</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span><span md-src-pos="6327..6328">.</span> <a href="https://github.com/bitcoin/bips/blob/master/bip-0375.mediawiki" md-src-pos="6329..6402">BIP-375</a> <span md-src-pos="6403..6419">describes how to</span>
        <span md-src-pos="6420..6453">send a silent payment with PSBTs.</span></p>
    <p md-src-pos="6455..6830"><span md-src-pos="6455..6463">However,</span> <span md-src-pos="6464..6507">since I could not find rust implementations</span> <span md-src-pos="6508..6522">of these BIPs,</span> <span
            md-src-pos="6523..6552">I propose to use a short-cut.</span> <span md-src-pos="6553..6585">Looking at the equation given in</span> (<span md-src-pos="6587..6588">1</span>)<span
            md-src-pos="6589..6590">,</span> <span md-src-pos="6591..6613">the first trader sends</span> <span class="math" inline="true" md-src-pos="6614..6624"><mjx-container class="MathJax CtxtMenu_Attached_0"
                                                                                                                                                                                 jax="SVG" tabindex="0"
                                                                                                                                                                                 ctxtmenu_counter="9032"
                                                                                                                                                                                 style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="4.291ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 1896.4 727" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.05ex;">
       <defs>
        <path id="MJX-9033-TEX-I-1D44E"
              d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
        <path id="MJX-9033-TEX-N-22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z"></path>
        <path id="MJX-9033-TEX-I-1D446"
              d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mi">
          <use data-c="1D44E" xlink:href="#MJX-9033-TEX-I-1D44E"></use>
         </g>
         <g data-mml-node="mo" transform="translate(751.2,0)">
          <use data-c="22C5" xlink:href="#MJX-9033-TEX-N-22C5"></use>
         </g>
         <g data-mml-node="mi" transform="translate(1251.4,0)">
          <use data-c="1D446" xlink:href="#MJX-9033-TEX-I-1D446"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>a</mi><mo></mo><mi>S</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="6625..6646">to the second trader.</span> <span md-src-pos="6647..6654">Sending</span> <span class="math" inline="true" md-src-pos="6655..6665"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9033" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="4.291ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 1896.4 727" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.05ex;">
       <defs>
        <path id="MJX-9034-TEX-I-1D44E"
              d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
        <path id="MJX-9034-TEX-N-22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z"></path>
        <path id="MJX-9034-TEX-I-1D446"
              d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mi">
          <use data-c="1D44E" xlink:href="#MJX-9034-TEX-I-1D44E"></use>
         </g>
         <g data-mml-node="mo" transform="translate(751.2,0)">
          <use data-c="22C5" xlink:href="#MJX-9034-TEX-N-22C5"></use>
         </g>
         <g data-mml-node="mi" transform="translate(1251.4,0)">
          <use data-c="1D446" xlink:href="#MJX-9034-TEX-I-1D446"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>a</mi><mo></mo><mi>S</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="6666..6705">does not compromise any knowledge about</span> <span class="math" inline="true" md-src-pos="6706..6709"><mjx-container class="MathJax CtxtMenu_Attached_0"
                                                                                                                                                                                  jax="SVG" tabindex="0"
                                                                                                                                                                                  ctxtmenu_counter="9034"
                                                                                                                                                                                  style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.197ex" height="1.02ex" role="img" focusable="false" viewBox="0 -441 529 451" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.023ex;">
       <defs>
        <path id="MJX-9035-TEX-I-1D44E"
              d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mi">
          <use data-c="1D44E" xlink:href="#MJX-9035-TEX-I-1D44E"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>a</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span><span md-src-pos="6709..6710">.</span> <span md-src-pos="6711..6728">The second trader</span> <span md-src-pos="6729..6747">then can calculate</span> <span class="math" inline="true"
                                                                                                                                                                                        md-src-pos="6748..6751"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0" ctxtmenu_counter="9035" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.717ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 759 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: 0px;">
       <defs>
        <path id="MJX-9036-TEX-I-1D435"
              d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mi">
          <use data-c="1D435" xlink:href="#MJX-9036-TEX-I-1D435"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>B</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="6752..6769">using the formula</span> (<span md-src-pos="6771..6772">1</span>) <span md-src-pos="6774..6810">and uses that as the payment address</span> <span
            md-src-pos="6811..6830">in the transaction.</span></p>
    <p md-src-pos="6832..7307"><span md-src-pos="6832..6851">This calculation of</span> <span class="math" inline="true" md-src-pos="6852..6855"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0"
                                                                                                                                                                ctxtmenu_counter="9036" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="1.717ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 759 683" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: 0px;">
       <defs>
        <path id="MJX-9037-TEX-I-1D435"
              d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mi">
          <use data-c="1D435" xlink:href="#MJX-9037-TEX-I-1D435"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>B</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="6856..6864">by using</span> <span class="math" inline="true" md-src-pos="6865..6876"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG" tabindex="0"
                                                                                                                                                   ctxtmenu_counter="9037" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="4.291ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 1896.4 727" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.05ex;">
       <defs>
        <path id="MJX-9038-TEX-I-1D44E"
              d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
        <path id="MJX-9038-TEX-N-22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z"></path>
        <path id="MJX-9038-TEX-I-1D446"
              d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mi">
          <use data-c="1D44E" xlink:href="#MJX-9038-TEX-I-1D44E"></use>
         </g>
         <g data-mml-node="mo" transform="translate(751.2,0)">
          <use data-c="22C5" xlink:href="#MJX-9038-TEX-N-22C5"></use>
         </g>
         <g data-mml-node="mi" transform="translate(1251.4,0)">
          <use data-c="1D446" xlink:href="#MJX-9038-TEX-I-1D446"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>a</mi><mo></mo><mi>S</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="6877..6926">from the first trader does not guarantee that the</span> <span md-src-pos="6927..6981">result is actually a silent payment address of the BM.</span> <span
            md-src-pos="6982..6990">However,</span> <span md-src-pos="6991..7022">the first trade cannot know the</span> <span md-src-pos="7023..7036">secret key of</span> <span class="math" inline="false"
                                                                                                                                                                                  md-src-pos="7037..7068"><mjx-container
            class="MathJax CtxtMenu_Attached_0" jax="SVG" display="true" tabindex="0" ctxtmenu_counter="9038" style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="18.553ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 8200.3 1000" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.566ex;">
       <defs>
        <path id="MJX-9039-TEX-I-1D446"
              d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path>
        <path id="MJX-9039-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path>
        <path id="MJX-9039-TEX-I-210E"
              d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path>
        <path id="MJX-9039-TEX-I-1D44E"
              d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
        <path id="MJX-9039-TEX-I-1D460"
              d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path>
        <path id="MJX-9039-TEX-N-28"
              d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path>
        <path id="MJX-9039-TEX-N-22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z"></path>
        <path id="MJX-9039-TEX-N-29"
              d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path>
        <path id="MJX-9039-TEX-I-1D43A"
              d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q492 659 471 656T418 643T357 615T294 567T236 496T189 394T158 260Q156 242 156 221Q156 173 170 136T206 79T256 45T308 28T353 24Q407 24 452 47T514 106Q517 114 529 161T541 214Q541 222 528 224T468 227H431Q425 233 425 235T427 254Q431 267 437 273H454Q494 271 594 271Q634 271 659 271T695 272T707 272Q721 272 721 263Q721 261 719 249Q714 230 709 228Q706 227 694 227Q674 227 653 224Q646 221 643 215T629 164Q620 131 614 108Q589 6 586 3Q584 1 581 1Q571 1 553 21T530 52Q530 53 528 52T522 47Q448 -22 322 -22Q201 -22 126 55T50 252Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mi">
          <use data-c="1D446" xlink:href="#MJX-9039-TEX-I-1D446"></use>
         </g>
         <g data-mml-node="mo" transform="translate(867.2,0)">
          <use data-c="2B" xlink:href="#MJX-9039-TEX-N-2B"></use>
         </g>
         <g data-mml-node="mi" transform="translate(1867.4,0)">
          <use data-c="210E" xlink:href="#MJX-9039-TEX-I-210E"></use>
         </g>
         <g data-mml-node="mi" transform="translate(2443.4,0)">
          <use data-c="1D44E" xlink:href="#MJX-9039-TEX-I-1D44E"></use>
         </g>
         <g data-mml-node="mi" transform="translate(2972.4,0)">
          <use data-c="1D460" xlink:href="#MJX-9039-TEX-I-1D460"></use>
         </g>
         <g data-mml-node="mi" transform="translate(3441.4,0)">
          <use data-c="210E" xlink:href="#MJX-9039-TEX-I-210E"></use>
         </g>
         <g data-mml-node="mo" transform="translate(4017.4,0)">
          <use data-c="28" xlink:href="#MJX-9039-TEX-N-28"></use>
         </g>
         <g data-mml-node="mi" transform="translate(4406.4,0)">
          <use data-c="1D44E" xlink:href="#MJX-9039-TEX-I-1D44E"></use>
         </g>
         <g data-mml-node="mo" transform="translate(5157.7,0)">
          <use data-c="22C5" xlink:href="#MJX-9039-TEX-N-22C5"></use>
         </g>
         <g data-mml-node="mi" transform="translate(5657.9,0)">
          <use data-c="1D446" xlink:href="#MJX-9039-TEX-I-1D446"></use>
         </g>
         <g data-mml-node="mo" transform="translate(6302.9,0)">
          <use data-c="29" xlink:href="#MJX-9039-TEX-N-29"></use>
         </g>
         <g data-mml-node="mo" transform="translate(6914.1,0)">
          <use data-c="22C5" xlink:href="#MJX-9039-TEX-N-22C5"></use>
         </g>
         <g data-mml-node="mi" transform="translate(7414.3,0)">
          <use data-c="1D43A" xlink:href="#MJX-9039-TEX-I-1D43A"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="block">
       <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
        <mi>S</mi><mo>+</mo><mi>h</mi><mi>a</mi><mi>s</mi><mi>h</mi><mo stretchy="false">(</mo><mi>a</mi><mo></mo><mi>S</mi><mo stretchy="false">)</mo><mo></mo><mi>G</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="7069..7094">no matter which value for</span> <span class="math" inline="true" md-src-pos="7095..7106"><mjx-container class="MathJax CtxtMenu_Attached_0" jax="SVG"
                                                                                                                                                                    tabindex="0" ctxtmenu_counter="9039"
                                                                                                                                                                    style="position: relative;">
      <svg xmlns="http://www.w3.org/2000/svg" width="4.291ex" height="1.645ex" role="img" focusable="false" viewBox="0 -705 1896.4 727" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true"
           style="vertical-align: -0.05ex;">
       <defs>
        <path id="MJX-9040-TEX-I-1D44E"
              d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
        <path id="MJX-9040-TEX-N-22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z"></path>
        <path id="MJX-9040-TEX-I-1D446"
              d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path>
       </defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)">
        <g data-mml-node="math">
         <g data-mml-node="mi">
          <use data-c="1D44E" xlink:href="#MJX-9040-TEX-I-1D44E"></use>
         </g>
         <g data-mml-node="mo" transform="translate(751.2,0)">
          <use data-c="22C5" xlink:href="#MJX-9040-TEX-N-22C5"></use>
         </g>
         <g data-mml-node="mi" transform="translate(1251.4,0)">
          <use data-c="1D446" xlink:href="#MJX-9040-TEX-I-1D446"></use>
         </g>
        </g>
       </g>
      </svg>
      <mjx-assistive-mml unselectable="on" display="inline">
       <math xmlns="http://www.w3.org/1998/Math/MathML">
        <mi>a</mi><mo></mo><mi>S</mi>
       </math>
      </mjx-assistive-mml>
     </mjx-container></span> <span md-src-pos="7107..7122">he will send to</span> <span md-src-pos="7123..7141">the second trader.</span> <span md-src-pos="7142..7222">So worst-case the first trader can trick the second trader into an address which</span>
        <span md-src-pos="7223..7250">is not spendable by anyone.</span> <span md-src-pos="7251..7263">In any case,</span> <span md-src-pos="7264..7307">the first trader will not have any benefit.</span></p>
</div>
</body>
</html>